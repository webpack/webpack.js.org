"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[1596],{1596:function(e,n,s){s.r(n),s.d(n,{default:function(){return o}});var a=s(2540),c=s(3317);function t(e){const n={a:"a",code:"code",em:"em",h2:"h2",p:"p",pre:"pre",span:"span",...(0,c.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.em,{children:"Context"})," refers to a ",(0,a.jsx)(n.a,{href:"/guides/dependency-management/#require-with-expression",children:"require with an expression"})," such as ",(0,a.jsx)(n.code,{children:"require('./locale/' + name + '.json')"}),". When encountering such an expression, webpack infers the directory (",(0,a.jsx)(n.code,{children:"'./locale/'"}),") and a regular expression (",(0,a.jsx)(n.code,{children:"/^.*\\.json$/"}),"). Since the ",(0,a.jsx)(n.code,{children:"name"})," is not known at compile time, webpack includes every file as module in the bundle."]}),"\n",(0,a.jsxs)(n.p,{children:["The ",(0,a.jsx)(n.code,{children:"ContextReplacementPlugin"})," allows you to override the inferred information. There are various ways to configure the plugin:"]}),"\n",(0,a.jsxs)(n.h2,{children:[(0,a.jsx)(n.span,{id:"usage"}),"Usage",(0,a.jsx)(n.a,{href:"#usage","aria-hidden":"true",tabIndex:"-1",children:(0,a.jsx)(n.span,{className:"header-link"})})]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsxs)(n.code,{className:"hljs language-typescript",children:[(0,a.jsx)(n.span,{className:"token keyword",children:"new"})," ",(0,a.jsx)(n.span,{className:"token class-name",children:"webpack"}),(0,a.jsx)(n.span,{className:"token punctuation",children:"."}),(0,a.jsx)(n.span,{className:"token function",children:"ContextReplacementPlugin"}),(0,a.jsx)(n.span,{className:"token punctuation",children:"("}),"\n  resourceRegExp",(0,a.jsx)(n.span,{className:"token operator",children:":"})," RegExp",(0,a.jsx)(n.span,{className:"token punctuation",children:","}),"\n  newContentResource",(0,a.jsx)(n.span,{className:"token operator",children:"?"}),(0,a.jsx)(n.span,{className:"token operator",children:":"})," ",(0,a.jsx)(n.span,{className:"token builtin",children:"string"}),(0,a.jsx)(n.span,{className:"token punctuation",children:","}),"\n  newContentRecursive",(0,a.jsx)(n.span,{className:"token operator",children:"?"}),(0,a.jsx)(n.span,{className:"token operator",children:":"})," ",(0,a.jsx)(n.span,{className:"token builtin",children:"boolean"}),(0,a.jsx)(n.span,{className:"token punctuation",children:","}),"\n  newContentRegExp",(0,a.jsx)(n.span,{className:"token operator",children:"?"}),(0,a.jsx)(n.span,{className:"token operator",children:":"})," RegExp\n",(0,a.jsx)(n.span,{className:"token punctuation",children:")"})]})}),"\n",(0,a.jsxs)(n.p,{children:["If the resource (directory) matches ",(0,a.jsx)(n.code,{children:"resourceRegExp"}),", the plugin replaces the default resource, recursive flag or generated regular expression with ",(0,a.jsx)(n.code,{children:"newContentResource"}),", ",(0,a.jsx)(n.code,{children:"newContentRecursive"})," or ",(0,a.jsx)(n.code,{children:"newContextRegExp"})," respectively. If ",(0,a.jsx)(n.code,{children:"newContentResource"})," is relative, it is resolved relative to the previous resource."]}),"\n",(0,a.jsx)(n.p,{children:"Here's a small example to restrict module usage:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsxs)(n.code,{className:"hljs language-javascript",children:[(0,a.jsx)(n.span,{className:"token keyword",children:"new"})," ",(0,a.jsxs)(n.span,{className:"token class-name",children:["webpack",(0,a.jsx)(n.span,{className:"token punctuation",children:"."}),"ContextReplacementPlugin"]}),(0,a.jsx)(n.span,{className:"token punctuation",children:"("}),(0,a.jsx)(n.span,{className:"token regex",children:"/moment[/\\\\]locale$/"}),(0,a.jsx)(n.span,{className:"token punctuation",children:","})," ",(0,a.jsx)(n.span,{className:"token regex",children:"/de|fr|hu/"}),(0,a.jsx)(n.span,{className:"token punctuation",children:")"}),(0,a.jsx)(n.span,{className:"token punctuation",children:";"})]})}),"\n",(0,a.jsxs)(n.p,{children:["The ",(0,a.jsx)(n.code,{children:"moment/locale"})," context is restricted to files matching ",(0,a.jsx)(n.code,{children:"/de|fr|hu/"}),". Thus only those locales are included (see ",(0,a.jsx)(n.a,{href:"https://github.com/moment/moment/issues/2373",children:"this issue"})," for more information)."]}),"\n",(0,a.jsxs)(n.h2,{children:[(0,a.jsx)(n.span,{id:"content-callback"}),"Content Callback",(0,a.jsx)(n.a,{href:"#content-callback","aria-hidden":"true",tabIndex:"-1",children:(0,a.jsx)(n.span,{className:"header-link"})})]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsxs)(n.code,{className:"hljs language-typescript",children:[(0,a.jsx)(n.span,{className:"token keyword",children:"new"})," ",(0,a.jsx)(n.span,{className:"token class-name",children:"webpack"}),(0,a.jsx)(n.span,{className:"token punctuation",children:"."}),(0,a.jsx)(n.span,{className:"token function",children:"ContextReplacementPlugin"}),(0,a.jsx)(n.span,{className:"token punctuation",children:"("}),"\n  resourceRegExp",(0,a.jsx)(n.span,{className:"token operator",children:":"})," RegExp",(0,a.jsx)(n.span,{className:"token punctuation",children:","}),"\n  ",(0,a.jsx)(n.span,{className:"token function-variable function",children:"newContentCallback"}),(0,a.jsx)(n.span,{className:"token operator",children:":"})," ",(0,a.jsx)(n.span,{className:"token punctuation",children:"("}),"data",(0,a.jsx)(n.span,{className:"token punctuation",children:")"})," ",(0,a.jsx)(n.span,{className:"token operator",children:"=>"})," ",(0,a.jsx)(n.span,{className:"token keyword",children:"void"}),"\n",(0,a.jsx)(n.span,{className:"token punctuation",children:")"}),(0,a.jsx)(n.span,{className:"token punctuation",children:";"})]})}),"\n",(0,a.jsxs)(n.p,{children:["The ",(0,a.jsx)(n.code,{children:"newContentCallback"})," function is given a ",(0,a.jsxs)(n.a,{href:"/api/plugins/module-factories/",children:[(0,a.jsx)(n.code,{children:"data"})," object of the ",(0,a.jsx)(n.code,{children:"ContextModuleFactory"})]})," and is expected to overwrite the ",(0,a.jsx)(n.code,{children:"request"})," attribute of the supplied object."]}),"\n",(0,a.jsx)(n.p,{children:"Using this callback we can dynamically redirect requests to a new location:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsxs)(n.code,{className:"hljs language-javascript",children:[(0,a.jsx)(n.span,{className:"token keyword",children:"new"})," ",(0,a.jsxs)(n.span,{className:"token class-name",children:["webpack",(0,a.jsx)(n.span,{className:"token punctuation",children:"."}),"ContextReplacementPlugin"]}),(0,a.jsx)(n.span,{className:"token punctuation",children:"("}),(0,a.jsx)(n.span,{className:"token regex",children:"/^\\.\\/locale$/"}),(0,a.jsx)(n.span,{className:"token punctuation",children:","})," ",(0,a.jsx)(n.span,{className:"token punctuation",children:"("}),(0,a.jsx)(n.span,{className:"token parameter",children:"context"}),(0,a.jsx)(n.span,{className:"token punctuation",children:")"})," ",(0,a.jsx)(n.span,{className:"token operator",children:"=>"})," ",(0,a.jsx)(n.span,{className:"token punctuation",children:"{"}),"\n  ",(0,a.jsx)(n.span,{className:"token keyword",children:"if"})," ",(0,a.jsx)(n.span,{className:"token punctuation",children:"("}),(0,a.jsx)(n.span,{className:"token operator",children:"!"}),(0,a.jsx)(n.span,{className:"token regex",children:"/\\/moment\\//"}),(0,a.jsx)(n.span,{className:"token punctuation",children:"."}),(0,a.jsx)(n.span,{className:"token function",children:"test"}),(0,a.jsx)(n.span,{className:"token punctuation",children:"("}),"context",(0,a.jsx)(n.span,{className:"token punctuation",children:"."}),"context",(0,a.jsx)(n.span,{className:"token punctuation",children:")"}),(0,a.jsx)(n.span,{className:"token punctuation",children:")"})," ",(0,a.jsx)(n.span,{className:"token keyword",children:"return"}),(0,a.jsx)(n.span,{className:"token punctuation",children:";"}),"\n\n  Object",(0,a.jsx)(n.span,{className:"token punctuation",children:"."}),(0,a.jsx)(n.span,{className:"token function",children:"assign"}),(0,a.jsx)(n.span,{className:"token punctuation",children:"("}),"context",(0,a.jsx)(n.span,{className:"token punctuation",children:","})," ",(0,a.jsx)(n.span,{className:"token punctuation",children:"{"}),"\n    regExp",(0,a.jsx)(n.span,{className:"token operator",children:":"})," ",(0,a.jsx)(n.span,{className:"token regex",children:"/^\\.\\/\\w+/"}),(0,a.jsx)(n.span,{className:"token punctuation",children:","}),"\n    request",(0,a.jsx)(n.span,{className:"token operator",children:":"})," ",(0,a.jsx)(n.span,{className:"token string",children:"'../../locale'"}),(0,a.jsx)(n.span,{className:"token punctuation",children:","})," ",(0,a.jsx)(n.span,{className:"token comment",children:"// resolved relatively"}),"\n  ",(0,a.jsx)(n.span,{className:"token punctuation",children:"}"}),(0,a.jsx)(n.span,{className:"token punctuation",children:")"}),(0,a.jsx)(n.span,{className:"token punctuation",children:";"}),"\n",(0,a.jsx)(n.span,{className:"token punctuation",children:"}"}),(0,a.jsx)(n.span,{className:"token punctuation",children:")"}),(0,a.jsx)(n.span,{className:"token punctuation",children:";"})]})}),"\n",(0,a.jsxs)(n.h2,{children:[(0,a.jsx)(n.span,{id:"other-options"}),"Other Options",(0,a.jsx)(n.a,{href:"#other-options","aria-hidden":"true",tabIndex:"-1",children:(0,a.jsx)(n.span,{className:"header-link"})})]}),"\n",(0,a.jsxs)(n.p,{children:["The ",(0,a.jsx)(n.code,{children:"newContentResource"})," and ",(0,a.jsx)(n.code,{children:"newContentCreateContextMap"})," parameters are also available:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsxs)(n.code,{className:"hljs language-typescript",children:[(0,a.jsx)(n.span,{className:"token keyword",children:"new"})," ",(0,a.jsx)(n.span,{className:"token class-name",children:"webpack"}),(0,a.jsx)(n.span,{className:"token punctuation",children:"."}),(0,a.jsx)(n.span,{className:"token function",children:"ContextReplacementPlugin"}),(0,a.jsx)(n.span,{className:"token punctuation",children:"("}),"\n  resourceRegExp",(0,a.jsx)(n.span,{className:"token operator",children:":"})," RegExp",(0,a.jsx)(n.span,{className:"token punctuation",children:","}),"\n  newContentResource",(0,a.jsx)(n.span,{className:"token operator",children:":"})," ",(0,a.jsx)(n.span,{className:"token builtin",children:"string"}),(0,a.jsx)(n.span,{className:"token punctuation",children:","}),"\n  newContentCreateContextMap",(0,a.jsx)(n.span,{className:"token operator",children:":"})," object ",(0,a.jsx)(n.span,{className:"token comment",children:"// mapping runtime-request (userRequest) to compile-time-request (request)"}),"\n",(0,a.jsx)(n.span,{className:"token punctuation",children:")"}),(0,a.jsx)(n.span,{className:"token punctuation",children:";"})]})}),"\n",(0,a.jsxs)(n.p,{children:["These two parameters can be used together to redirect requests in a more targeted way. The ",(0,a.jsx)(n.code,{children:"newContentCreateContextMap"})," allows you to map runtime requests to compile requests in the form of an object:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsxs)(n.code,{className:"hljs language-javascript",children:[(0,a.jsx)(n.span,{className:"token keyword",children:"new"})," ",(0,a.jsx)(n.span,{className:"token class-name",children:"ContextReplacementPlugin"}),(0,a.jsx)(n.span,{className:"token punctuation",children:"("}),(0,a.jsx)(n.span,{className:"token regex",children:"/selector/"}),(0,a.jsx)(n.span,{className:"token punctuation",children:","})," ",(0,a.jsx)(n.span,{className:"token string",children:"'./folder'"}),(0,a.jsx)(n.span,{className:"token punctuation",children:","})," ",(0,a.jsx)(n.span,{className:"token punctuation",children:"{"}),"\n  ",(0,a.jsx)(n.span,{className:"token string",children:"'./request'"}),(0,a.jsx)(n.span,{className:"token operator",children:":"})," ",(0,a.jsx)(n.span,{className:"token string",children:"'./request'"}),(0,a.jsx)(n.span,{className:"token punctuation",children:","}),"\n  ",(0,a.jsx)(n.span,{className:"token string",children:"'./other-request'"}),(0,a.jsx)(n.span,{className:"token operator",children:":"})," ",(0,a.jsx)(n.span,{className:"token string",children:"'./new-request'"}),(0,a.jsx)(n.span,{className:"token punctuation",children:","}),"\n",(0,a.jsx)(n.span,{className:"token punctuation",children:"}"}),(0,a.jsx)(n.span,{className:"token punctuation",children:")"}),(0,a.jsx)(n.span,{className:"token punctuation",children:";"})]})})]})}function o(e={}){const{wrapper:n}={...(0,c.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(t,{...e})}):t(e)}}}]);