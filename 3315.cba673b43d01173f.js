"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3315],{3315:function(n,e,s){s.r(e),s.d(e,{default:function(){return c}});var a=s(2540),o=s(3317);function t(n){const e={a:"a",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",span:"span",strong:"strong",ul:"ul",...(0,o.R)(),...n.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{align:"center"}),"\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.a,{href:"https://npmjs.com/package/thread-loader",children:(0,a.jsx)(e.img,{src:"https://img.shields.io/npm/v/thread-loader.svg",alt:"npm"})}),"\n",(0,a.jsx)(e.a,{href:"https://nodejs.org",children:(0,a.jsx)(e.img,{src:"https://img.shields.io/node/v/thread-loader.svg",alt:"node"})}),"\n",(0,a.jsx)(e.a,{href:"https://github.com/webpack/thread-loader/actions",children:(0,a.jsx)(e.img,{src:"https://github.com/webpack/thread-loader/workflows/thread-loader/badge.svg",alt:"tests"})}),"\n",(0,a.jsx)(e.a,{href:"https://codecov.io/gh/webpack/thread-loader",children:(0,a.jsx)(e.img,{src:"https://codecov.io/gh/webpack/thread-loader/branch/main/graph/badge.svg",alt:"coverage"})}),"\n",(0,a.jsx)(e.a,{href:"https://github.com/webpack/webpack/discussions",children:(0,a.jsx)(e.img,{src:"https://img.shields.io/github/discussions/webpack/webpack",alt:"discussion"})}),"\n",(0,a.jsx)(e.a,{href:"https://packagephobia.now.sh/result?p=thread-loader",children:(0,a.jsx)(e.img,{src:"https://packagephobia.now.sh/badge?p=thread-loader",alt:"size"})})]}),"\n",(0,a.jsx)(e.p,{children:"Runs the specified loaders in a worker pool."}),"\n",(0,a.jsxs)(e.h2,{children:[(0,a.jsx)(e.span,{id:"getting-started"}),"Getting Started",(0,a.jsx)(e.a,{href:"#getting-started","aria-hidden":"true",tabIndex:"-1",children:(0,a.jsx)(e.span,{className:"header-link"})})]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsxs)(e.code,{className:"hljs language-bash",children:[(0,a.jsx)(e.span,{className:"token function",children:"npm"})," ",(0,a.jsx)(e.span,{className:"token function",children:"install"})," --save-dev thread-loader"]})}),"\n",(0,a.jsx)(e.p,{children:"or"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsxs)(e.code,{className:"hljs language-bash",children:[(0,a.jsx)(e.span,{className:"token function",children:"yarn"})," ",(0,a.jsx)(e.span,{className:"token function",children:"add"})," -D thread-loader"]})}),"\n",(0,a.jsx)(e.p,{children:"or"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsxs)(e.code,{className:"hljs language-bash",children:[(0,a.jsx)(e.span,{className:"token function",children:"pnpm"})," ",(0,a.jsx)(e.span,{className:"token function",children:"add"})," -D thread-loader"]})}),"\n",(0,a.jsx)(e.p,{children:"Put this loader in front of other loaders.\nThe following loaders run in a worker pool."}),"\n",(0,a.jsx)(e.p,{children:"Loaders running in a worker pool have limitations. Examples:"}),"\n",(0,a.jsxs)(e.ul,{children:["\n",(0,a.jsx)(e.li,{children:"Loaders cannot emit files."}),"\n",(0,a.jsx)(e.li,{children:"Loaders cannot use custom loader APIs (i.e. by plugins)."}),"\n",(0,a.jsx)(e.li,{children:"Loaders cannot access webpack options."}),"\n"]}),"\n",(0,a.jsx)(e.p,{children:"Each worker is a separate Node.js process, which has an overhead of ~600ms. There is also additional overhead from inter-process communication."}),"\n",(0,a.jsxs)(e.blockquote,{children:["\n",(0,a.jsx)(e.p,{children:"Use this loader only for expensive operations!"}),"\n"]}),"\n",(0,a.jsxs)(e.h3,{children:[(0,a.jsx)(e.span,{id:"examples"}),"Examples",(0,a.jsx)(e.a,{href:"#examples","aria-hidden":"true",tabIndex:"-1",children:(0,a.jsx)(e.span,{className:"header-link"})})]}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.strong,{children:"webpack.config.js"})}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsxs)(e.code,{className:"hljs language-js",children:["module",(0,a.jsx)(e.span,{className:"token punctuation",children:"."}),"exports ",(0,a.jsx)(e.span,{className:"token operator",children:"="})," ",(0,a.jsx)(e.span,{className:"token punctuation",children:"{"}),"\n  module",(0,a.jsx)(e.span,{className:"token operator",children:":"})," ",(0,a.jsx)(e.span,{className:"token punctuation",children:"{"}),"\n    rules",(0,a.jsx)(e.span,{className:"token operator",children:":"})," ",(0,a.jsx)(e.span,{className:"token punctuation",children:"["}),"\n      ",(0,a.jsx)(e.span,{className:"token punctuation",children:"{"}),"\n        test",(0,a.jsx)(e.span,{className:"token operator",children:":"})," ",(0,a.jsx)(e.span,{className:"token regex",children:"/\\.js$/"}),(0,a.jsx)(e.span,{className:"token punctuation",children:","}),"\n        include",(0,a.jsx)(e.span,{className:"token operator",children:":"})," path",(0,a.jsx)(e.span,{className:"token punctuation",children:"."}),(0,a.jsx)(e.span,{className:"token function",children:"resolve"}),(0,a.jsx)(e.span,{className:"token punctuation",children:"("}),(0,a.jsx)(e.span,{className:"token string",children:"'src'"}),(0,a.jsx)(e.span,{className:"token punctuation",children:")"}),(0,a.jsx)(e.span,{className:"token punctuation",children:","}),"\n        use",(0,a.jsx)(e.span,{className:"token operator",children:":"})," ",(0,a.jsx)(e.span,{className:"token punctuation",children:"["}),"\n          ",(0,a.jsx)(e.span,{className:"token string",children:"'thread-loader'"}),(0,a.jsx)(e.span,{className:"token punctuation",children:","}),"\n          ",(0,a.jsx)(e.span,{className:"token comment",children:"// your expensive loader (e.g babel-loader)"}),"\n        ",(0,a.jsx)(e.span,{className:"token punctuation",children:"]"}),(0,a.jsx)(e.span,{className:"token punctuation",children:","}),"\n      ",(0,a.jsx)(e.span,{className:"token punctuation",children:"}"}),(0,a.jsx)(e.span,{className:"token punctuation",children:","}),"\n    ",(0,a.jsx)(e.span,{className:"token punctuation",children:"]"}),(0,a.jsx)(e.span,{className:"token punctuation",children:","}),"\n  ",(0,a.jsx)(e.span,{className:"token punctuation",children:"}"}),(0,a.jsx)(e.span,{className:"token punctuation",children:","}),"\n",(0,a.jsx)(e.span,{className:"token punctuation",children:"}"}),(0,a.jsx)(e.span,{className:"token punctuation",children:";"})]})}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.strong,{children:"with options"})}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsxs)(e.code,{className:"hljs language-js",children:["use",(0,a.jsx)(e.span,{className:"token operator",children:":"})," ",(0,a.jsx)(e.span,{className:"token punctuation",children:"["}),"\n  ",(0,a.jsx)(e.span,{className:"token punctuation",children:"{"}),"\n    loader",(0,a.jsx)(e.span,{className:"token operator",children:":"})," ",(0,a.jsx)(e.span,{className:"token string",children:"'thread-loader'"}),(0,a.jsx)(e.span,{className:"token punctuation",children:","}),"\n    ",(0,a.jsx)(e.span,{className:"token comment",children:"// loaders with equal options will share worker pools"}),"\n    options",(0,a.jsx)(e.span,{className:"token operator",children:":"})," ",(0,a.jsx)(e.span,{className:"token punctuation",children:"{"}),"\n      ",(0,a.jsx)(e.span,{className:"token comment",children:"// the number of spawned workers, defaults to (number of cpus - 1) or"}),"\n      ",(0,a.jsx)(e.span,{className:"token comment",children:"// fallback to 1 when require('os').cpus() is undefined"}),"\n      workers",(0,a.jsx)(e.span,{className:"token operator",children:":"})," ",(0,a.jsx)(e.span,{className:"token number",children:"2"}),(0,a.jsx)(e.span,{className:"token punctuation",children:","}),"\n\n      ",(0,a.jsx)(e.span,{className:"token comment",children:"// number of jobs a worker processes in parallel"}),"\n      ",(0,a.jsx)(e.span,{className:"token comment",children:"// defaults to 20"}),"\n      workerParallelJobs",(0,a.jsx)(e.span,{className:"token operator",children:":"})," ",(0,a.jsx)(e.span,{className:"token number",children:"50"}),(0,a.jsx)(e.span,{className:"token punctuation",children:","}),"\n\n      ",(0,a.jsx)(e.span,{className:"token comment",children:"// additional node.js arguments"}),"\n      workerNodeArgs",(0,a.jsx)(e.span,{className:"token operator",children:":"})," ",(0,a.jsx)(e.span,{className:"token punctuation",children:"["}),(0,a.jsx)(e.span,{className:"token string",children:"'--max-old-space-size=1024'"}),(0,a.jsx)(e.span,{className:"token punctuation",children:"]"}),(0,a.jsx)(e.span,{className:"token punctuation",children:","}),"\n\n      ",(0,a.jsx)(e.span,{className:"token comment",children:"// Allow to respawn a dead worker pool"}),"\n      ",(0,a.jsx)(e.span,{className:"token comment",children:"// respawning slows down the entire compilation"}),"\n      ",(0,a.jsx)(e.span,{className:"token comment",children:"// and should be set to false for development"}),"\n      poolRespawn",(0,a.jsx)(e.span,{className:"token operator",children:":"})," ",(0,a.jsx)(e.span,{className:"token boolean",children:"false"}),(0,a.jsx)(e.span,{className:"token punctuation",children:","}),"\n\n      ",(0,a.jsx)(e.span,{className:"token comment",children:"// timeout for killing the worker processes when idle"}),"\n      ",(0,a.jsx)(e.span,{className:"token comment",children:"// defaults to 500 (ms)"}),"\n      ",(0,a.jsx)(e.span,{className:"token comment",children:"// can be set to Infinity for watching builds to keep workers alive"}),"\n      poolTimeout",(0,a.jsx)(e.span,{className:"token operator",children:":"})," ",(0,a.jsx)(e.span,{className:"token number",children:"2000"}),(0,a.jsx)(e.span,{className:"token punctuation",children:","}),"\n\n      ",(0,a.jsx)(e.span,{className:"token comment",children:"// number of jobs the pool distributes to the workers"}),"\n      ",(0,a.jsx)(e.span,{className:"token comment",children:"// defaults to 200"}),"\n      ",(0,a.jsx)(e.span,{className:"token comment",children:"// decrease for less efficient but more fair distribution"}),"\n      poolParallelJobs",(0,a.jsx)(e.span,{className:"token operator",children:":"})," ",(0,a.jsx)(e.span,{className:"token number",children:"50"}),(0,a.jsx)(e.span,{className:"token punctuation",children:","}),"\n\n      ",(0,a.jsx)(e.span,{className:"token comment",children:"// name of the pool"}),"\n      ",(0,a.jsx)(e.span,{className:"token comment",children:"// can be used to create different pools with otherwise identical options"}),"\n      name",(0,a.jsx)(e.span,{className:"token operator",children:":"})," ",(0,a.jsx)(e.span,{className:"token string",children:"'my-pool'"}),(0,a.jsx)(e.span,{className:"token punctuation",children:","}),"\n    ",(0,a.jsx)(e.span,{className:"token punctuation",children:"}"}),(0,a.jsx)(e.span,{className:"token punctuation",children:","}),"\n  ",(0,a.jsx)(e.span,{className:"token punctuation",children:"}"}),(0,a.jsx)(e.span,{className:"token punctuation",children:","}),"\n  ",(0,a.jsx)(e.span,{className:"token comment",children:"// your expensive loader (e.g babel-loader)"}),"\n",(0,a.jsx)(e.span,{className:"token punctuation",children:"]"}),(0,a.jsx)(e.span,{className:"token punctuation",children:";"})]})}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.strong,{children:"prewarming"})}),"\n",(0,a.jsx)(e.p,{children:"To prevent the high delays when booting workers, it is possible to warm up the worker pool."}),"\n",(0,a.jsx)(e.p,{children:"This boots the max number of workers in the pool and loads the specified modules into the Node.js module cache."}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsxs)(e.code,{className:"hljs language-js",children:[(0,a.jsx)(e.span,{className:"token keyword",children:"const"})," threadLoader ",(0,a.jsx)(e.span,{className:"token operator",children:"="})," ",(0,a.jsx)(e.span,{className:"token function",children:"require"}),(0,a.jsx)(e.span,{className:"token punctuation",children:"("}),(0,a.jsx)(e.span,{className:"token string",children:"'thread-loader'"}),(0,a.jsx)(e.span,{className:"token punctuation",children:")"}),(0,a.jsx)(e.span,{className:"token punctuation",children:";"}),"\n\nthreadLoader",(0,a.jsx)(e.span,{className:"token punctuation",children:"."}),(0,a.jsx)(e.span,{className:"token function",children:"warmup"}),(0,a.jsx)(e.span,{className:"token punctuation",children:"("}),"\n  ",(0,a.jsx)(e.span,{className:"token punctuation",children:"{"}),"\n    ",(0,a.jsx)(e.span,{className:"token comment",children:"// pool options, like passed to loader options"}),"\n    ",(0,a.jsx)(e.span,{className:"token comment",children:"// must match loader options to boot the correct pool"}),"\n  ",(0,a.jsx)(e.span,{className:"token punctuation",children:"}"}),(0,a.jsx)(e.span,{className:"token punctuation",children:","}),"\n  ",(0,a.jsx)(e.span,{className:"token punctuation",children:"["}),"\n    ",(0,a.jsx)(e.span,{className:"token comment",children:"// modules to load"}),"\n    ",(0,a.jsx)(e.span,{className:"token comment",children:"// can be any module, i.e."}),"\n    ",(0,a.jsx)(e.span,{className:"token string",children:"'babel-loader'"}),(0,a.jsx)(e.span,{className:"token punctuation",children:","}),"\n    ",(0,a.jsx)(e.span,{className:"token string",children:"'@babel/preset-env'"}),(0,a.jsx)(e.span,{className:"token punctuation",children:","}),"\n    ",(0,a.jsx)(e.span,{className:"token string",children:"'sass-loader'"}),(0,a.jsx)(e.span,{className:"token punctuation",children:","}),"\n  ",(0,a.jsx)(e.span,{className:"token punctuation",children:"]"}),(0,a.jsx)(e.span,{className:"token punctuation",children:","}),"\n",(0,a.jsx)(e.span,{className:"token punctuation",children:")"}),(0,a.jsx)(e.span,{className:"token punctuation",children:";"})]})}),"\n",(0,a.jsxs)(e.h2,{children:[(0,a.jsx)(e.span,{id:"contributing"}),"Contributing",(0,a.jsx)(e.a,{href:"#contributing","aria-hidden":"true",tabIndex:"-1",children:(0,a.jsx)(e.span,{className:"header-link"})})]}),"\n",(0,a.jsx)(e.p,{children:"We welcome all contributions!\nIf you're new here, please take a moment to review our contributing guidelines before submitting issues or pull requests."}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.a,{href:"https://github.com/webpack/thread-loader/main/.github/CONTRIBUTING.md",children:"CONTRIBUTING"})}),"\n",(0,a.jsxs)(e.h2,{children:[(0,a.jsx)(e.span,{id:"license"}),"License",(0,a.jsx)(e.a,{href:"#license","aria-hidden":"true",tabIndex:"-1",children:(0,a.jsx)(e.span,{className:"header-link"})})]}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.a,{href:"https://github.com/webpack/thread-loader/main/LICENSE",children:"MIT"})})]})}function c(n={}){const{wrapper:e}={...(0,o.R)(),...n.components};return e?(0,a.jsx)(e,{...n,children:(0,a.jsx)(t,{...n})}):t(n)}}}]);