"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3423],{3423:function(e,n,s){s.r(n),s.d(n,{default:function(){return c}});var a=s(2540),l=s(3317);function i(e){const n={a:"a",aside:"aside",blockquote:"blockquote",code:"code",em:"em",h2:"h2",h6:"h6",p:"p",pre:"pre",span:"span",strong:"strong",...(0,l.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(n.p,{children:["The ",(0,a.jsx)(n.code,{children:"webpack"})," compiler can understand modules written as ES2015 modules, CommonJS or AMD. However, some third party libraries may expect global dependencies (e.g. ",(0,a.jsx)(n.code,{children:"$"})," for ",(0,a.jsx)(n.code,{children:"jQuery"}),'). The libraries might also create globals which need to be exported. These "broken modules" are one instance where ',(0,a.jsx)(n.em,{children:"shimming"})," comes into play."]}),"\n",(0,a.jsxs)(n.aside,{className:"warning",children:[(0,a.jsx)(n.h6,{className:"warning__prefix",children:"warning"}),(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"We don't recommend using globals!"})," The whole concept behind webpack is to allow more modular front-end development. This means writing isolated modules that are well contained and do not rely on hidden dependencies (e.g. globals). Please use these features only when necessary."]})]}),"\n",(0,a.jsxs)(n.p,{children:["Another instance where ",(0,a.jsx)(n.em,{children:"shimming"})," can be useful is when you want to ",(0,a.jsx)(n.a,{href:"https://en.wikipedia.org/wiki/Polyfill_%28programming%29",children:"polyfill"})," browser functionality to support more users. In this case, you may only want to deliver those polyfills to the browsers that need patching (i.e. load them on demand)."]}),"\n",(0,a.jsx)(n.p,{children:"The following article will walk through both of these use cases."}),"\n",(0,a.jsxs)(n.aside,{className:"tip",children:[(0,a.jsx)(n.h6,{className:"tip__prefix",children:"tip"}),(0,a.jsxs)(n.p,{children:["For simplicity, this guide stems from the examples in ",(0,a.jsx)(n.a,{href:"/guides/getting-started",children:"Getting Started"}),". Please make sure you are familiar with the setup there before moving on."]})]}),"\n",(0,a.jsxs)(n.h2,{children:[(0,a.jsx)(n.span,{id:"shimming-globals"}),"Shimming Globals",(0,a.jsx)(n.a,{href:"#shimming-globals","aria-hidden":"true",tabIndex:"-1",children:(0,a.jsx)(n.span,{className:"header-link"})})]}),"\n",(0,a.jsx)(n.p,{children:"Let's start with the first use case of shimming global variables. Before we do anything let's take another look at our project:"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"project"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsxs)(n.code,{className:"hljs language-diff",children:["webpack-demo\n|- package.json\n|- package-lock.json\n|- webpack.config.js\n|- /dist\n",(0,a.jsxs)(n.span,{className:"token unchanged",children:[(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:" |- index.html\n"})]}),"|- /src\n",(0,a.jsxs)(n.span,{className:"token unchanged",children:[(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:" |- index.js\n"})]}),"|- /node_modules"]})}),"\n",(0,a.jsxs)(n.p,{children:["Remember that ",(0,a.jsx)(n.code,{children:"lodash"})," package we were using? For demonstration purposes, let's say we wanted to instead provide this as a global throughout our application. To do this, we can use ",(0,a.jsx)(n.code,{children:"ProvidePlugin"}),"."]}),"\n",(0,a.jsxs)(n.p,{children:["The ",(0,a.jsx)(n.a,{href:"/plugins/provide-plugin",children:(0,a.jsx)(n.code,{children:"ProvidePlugin"})})," makes a package available as a variable in every module compiled through webpack. If webpack sees that variable used, it will include the given package in the final bundle. Let's go ahead by removing the ",(0,a.jsx)(n.code,{children:"import"})," statement for ",(0,a.jsx)(n.code,{children:"lodash"})," and instead provide it via the plugin:"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"src/index.js"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsxs)(n.code,{className:"hljs language-diff",children:[(0,a.jsxs)(n.span,{className:"token deleted-sign deleted",children:[(0,a.jsx)(n.span,{className:"token prefix deleted",children:"-"}),(0,a.jsx)(n.span,{className:"token line",children:"import _ from 'lodash';\n"}),(0,a.jsx)(n.span,{className:"token prefix deleted",children:"-"}),(0,a.jsx)(n.span,{className:"token line",children:"\n"})]}),(0,a.jsxs)(n.span,{className:"token unchanged",children:[(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"function component() {\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"  const element = document.createElement('div');\n"})]}),"\n",(0,a.jsxs)(n.span,{className:"token deleted-sign deleted",children:[(0,a.jsx)(n.span,{className:"token prefix deleted",children:"-"}),(0,a.jsx)(n.span,{className:"token line",children:"  // Lodash, now imported by this script\n"})]}),(0,a.jsxs)(n.span,{className:"token unchanged",children:[(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"  element.innerHTML = _.join(['Hello', 'webpack'], ' ');\n"})]}),"\n",(0,a.jsxs)(n.span,{className:"token unchanged",children:[(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"  return element;\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"}\n"})]}),"\n",(0,a.jsxs)(n.span,{className:"token unchanged",children:[(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"document.body.appendChild(component());"})]})]})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"webpack.config.js"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsxs)(n.code,{className:"hljs language-diff",children:[(0,a.jsxs)(n.span,{className:"token unchanged",children:[(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"const path = require('path');\n"})]}),(0,a.jsxs)(n.span,{className:"token inserted-sign inserted",children:[(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"const webpack = require('webpack');\n"})]}),"\n",(0,a.jsxs)(n.span,{className:"token unchanged",children:[(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"module.exports = {\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"  entry: './src/index.js',\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"  output: {\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"    filename: 'main.js',\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"    path: path.resolve(__dirname, 'dist'),\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"  },\n"})]}),(0,a.jsxs)(n.span,{className:"token inserted-sign inserted",children:[(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"  plugins: [\n"}),(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"    new webpack.ProvidePlugin({\n"}),(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"      _: 'lodash',\n"}),(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"    }),\n"}),(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"  ],\n"})]}),(0,a.jsxs)(n.span,{className:"token unchanged",children:[(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"};"})]})]})}),"\n",(0,a.jsx)(n.p,{children:"What we've essentially done here is tell webpack..."}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsxs)(n.p,{children:["If you encounter at least one instance of the variable ",(0,a.jsx)(n.code,{children:"_"}),", include the ",(0,a.jsx)(n.code,{children:"lodash"})," package and provide it to the modules that need it."]}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"If we run a build, we should still see the same output:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsxs)(n.code,{className:"hljs language-bash",children:["$ ",(0,a.jsx)(n.span,{className:"token function",children:"npm"})," run build\n\n",(0,a.jsx)(n.span,{className:"token punctuation",children:".."}),"\n\n",(0,a.jsx)(n.span,{className:"token punctuation",children:"["}),"webpack-cli",(0,a.jsx)(n.span,{className:"token punctuation",children:"]"})," Compilation finished\nasset main.js ",(0,a.jsx)(n.span,{className:"token number",children:"69.1"})," KiB ",(0,a.jsx)(n.span,{className:"token punctuation",children:"["}),"emitted",(0,a.jsx)(n.span,{className:"token punctuation",children:"]"})," ",(0,a.jsx)(n.span,{className:"token punctuation",children:"["}),"minimized",(0,a.jsx)(n.span,{className:"token punctuation",children:"]"})," ",(0,a.jsx)(n.span,{className:"token punctuation",children:"("}),"name: main",(0,a.jsx)(n.span,{className:"token punctuation",children:")"})," ",(0,a.jsx)(n.span,{className:"token number",children:"1"})," related asset\nruntime modules ",(0,a.jsx)(n.span,{className:"token number",children:"344"})," bytes ",(0,a.jsx)(n.span,{className:"token number",children:"2"})," modules\ncacheable modules ",(0,a.jsx)(n.span,{className:"token number",children:"530"})," KiB\n  ./src/index.js ",(0,a.jsx)(n.span,{className:"token number",children:"191"})," bytes ",(0,a.jsx)(n.span,{className:"token punctuation",children:"["}),"built",(0,a.jsx)(n.span,{className:"token punctuation",children:"]"})," ",(0,a.jsx)(n.span,{className:"token punctuation",children:"["}),"code generated",(0,a.jsx)(n.span,{className:"token punctuation",children:"]"}),"\n  ./node_modules/lodash/lodash.js ",(0,a.jsx)(n.span,{className:"token number",children:"530"})," KiB ",(0,a.jsx)(n.span,{className:"token punctuation",children:"["}),"built",(0,a.jsx)(n.span,{className:"token punctuation",children:"]"})," ",(0,a.jsx)(n.span,{className:"token punctuation",children:"["}),"code generated",(0,a.jsx)(n.span,{className:"token punctuation",children:"]"}),"\nwebpack ",(0,a.jsx)(n.span,{className:"token number",children:"5.4"}),".0 compiled successfully ",(0,a.jsx)(n.span,{className:"token keyword",children:"in"})," ",(0,a.jsx)(n.span,{className:"token number",children:"2910"})," ms"]})}),"\n",(0,a.jsxs)(n.p,{children:["We can also use the ",(0,a.jsx)(n.code,{children:"ProvidePlugin"}),' to expose a single export of a module by configuring it with an "array path" (e.g. ',(0,a.jsx)(n.code,{children:"[module, child, ...children?]"}),"). So let's imagine we only wanted to provide the ",(0,a.jsx)(n.code,{children:"join"})," method from ",(0,a.jsx)(n.code,{children:"lodash"})," wherever it's invoked:"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"src/index.js"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsxs)(n.code,{className:"hljs language-diff",children:[(0,a.jsxs)(n.span,{className:"token unchanged",children:[(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"function component() {\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"  const element = document.createElement('div');\n"})]}),"\n",(0,a.jsxs)(n.span,{className:"token deleted-sign deleted",children:[(0,a.jsx)(n.span,{className:"token prefix deleted",children:"-"}),(0,a.jsx)(n.span,{className:"token line",children:"  element.innerHTML = _.join(['Hello', 'webpack'], ' ');\n"})]}),(0,a.jsxs)(n.span,{className:"token inserted-sign inserted",children:[(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"  element.innerHTML = join(['Hello', 'webpack'], ' ');\n"})]}),"\n",(0,a.jsxs)(n.span,{className:"token unchanged",children:[(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"  return element;\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"}\n"})]}),"\n",(0,a.jsxs)(n.span,{className:"token unchanged",children:[(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"document.body.appendChild(component());"})]})]})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"webpack.config.js"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsxs)(n.code,{className:"hljs language-diff",children:[(0,a.jsxs)(n.span,{className:"token unchanged",children:[(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"const path = require('path');\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"const webpack = require('webpack');\n"})]}),"\n",(0,a.jsxs)(n.span,{className:"token unchanged",children:[(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"module.exports = {\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"  entry: './src/index.js',\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"  output: {\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"    filename: 'main.js',\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"    path: path.resolve(__dirname, 'dist'),\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"  },\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"  plugins: [\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"    new webpack.ProvidePlugin({\n"})]}),(0,a.jsxs)(n.span,{className:"token deleted-sign deleted",children:[(0,a.jsx)(n.span,{className:"token prefix deleted",children:"-"}),(0,a.jsx)(n.span,{className:"token line",children:"      _: 'lodash',\n"})]}),(0,a.jsxs)(n.span,{className:"token inserted-sign inserted",children:[(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"      join: ['lodash', 'join'],\n"})]}),(0,a.jsxs)(n.span,{className:"token unchanged",children:[(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"    }),\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"  ],\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"};"})]})]})}),"\n",(0,a.jsxs)(n.p,{children:["This would go nicely with ",(0,a.jsx)(n.a,{href:"/guides/tree-shaking",children:"Tree Shaking"})," as the rest of the ",(0,a.jsx)(n.code,{children:"lodash"})," library should get dropped."]}),"\n",(0,a.jsxs)(n.h2,{children:[(0,a.jsx)(n.span,{id:"granular-shimming"}),"Granular Shimming",(0,a.jsx)(n.a,{href:"#granular-shimming","aria-hidden":"true",tabIndex:"-1",children:(0,a.jsx)(n.span,{className:"header-link"})})]}),"\n",(0,a.jsxs)(n.p,{children:["Some legacy modules rely on ",(0,a.jsx)(n.code,{children:"this"})," being the ",(0,a.jsx)(n.code,{children:"window"})," object. Let's update our ",(0,a.jsx)(n.code,{children:"index.js"})," so this is the case:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsxs)(n.code,{className:"hljs language-diff",children:[(0,a.jsxs)(n.span,{className:"token unchanged",children:[(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"function component() {\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"  const element = document.createElement('div');\n"})]}),"\n",(0,a.jsxs)(n.span,{className:"token unchanged",children:[(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"  element.innerHTML = join(['Hello', 'webpack'], ' ');\n"})]}),"\n",(0,a.jsxs)(n.span,{className:"token inserted-sign inserted",children:[(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"  // Assume we are in the context of `window`\n"}),(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:'  this.alert("Hmmm, this probably isn\'t a great idea...");\n'}),(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"\n"})]}),(0,a.jsxs)(n.span,{className:"token unchanged",children:[(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"  return element;\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"}\n"})]}),"\n",(0,a.jsxs)(n.span,{className:"token unchanged",children:[(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"document.body.appendChild(component());"})]})]})}),"\n",(0,a.jsxs)(n.p,{children:["This becomes a problem when the module is executed in a CommonJS context where ",(0,a.jsx)(n.code,{children:"this"})," is equal to ",(0,a.jsx)(n.code,{children:"module.exports"}),". In this case you can override ",(0,a.jsx)(n.code,{children:"this"})," using the ",(0,a.jsx)(n.a,{href:"/loaders/imports-loader/",children:(0,a.jsx)(n.code,{children:"imports-loader"})}),":"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"webpack.config.js"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsxs)(n.code,{className:"hljs language-diff",children:[(0,a.jsxs)(n.span,{className:"token unchanged",children:[(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"const path = require('path');\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"const webpack = require('webpack');\n"})]}),"\n",(0,a.jsxs)(n.span,{className:"token unchanged",children:[(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"module.exports = {\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"  entry: './src/index.js',\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"  output: {\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"    filename: 'main.js',\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"    path: path.resolve(__dirname, 'dist'),\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"  },\n"})]}),(0,a.jsxs)(n.span,{className:"token inserted-sign inserted",children:[(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"  module: {\n"}),(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"    rules: [\n"}),(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"      {\n"}),(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"        test: require.resolve('./src/index.js'),\n"}),(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"        use: 'imports-loader?wrapper=window',\n"}),(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"      },\n"}),(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"    ],\n"}),(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"  },\n"})]}),(0,a.jsxs)(n.span,{className:"token unchanged",children:[(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"  plugins: [\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"    new webpack.ProvidePlugin({\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"      join: ['lodash', 'join'],\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"    }),\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"  ],\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"};"})]})]})}),"\n",(0,a.jsxs)(n.h2,{children:[(0,a.jsx)(n.span,{id:"global-exports"}),"Global Exports",(0,a.jsx)(n.a,{href:"#global-exports","aria-hidden":"true",tabIndex:"-1",children:(0,a.jsx)(n.span,{className:"header-link"})})]}),"\n",(0,a.jsx)(n.p,{children:"Let's say a library creates a global variable that it expects its consumers to use. We can add a small module to our setup to demonstrate this:"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"project"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsxs)(n.code,{className:"hljs language-diff",children:[(0,a.jsxs)(n.span,{className:"token unchanged",children:[(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:" webpack-demo\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:" |- package.json\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:" |- package-lock.json\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:" |- webpack.config.js\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:" |- /dist\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:" |- /src\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"   |- index.js\n"})]}),(0,a.jsxs)(n.span,{className:"token inserted-sign inserted",children:[(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"   |- globals.js\n"})]}),(0,a.jsxs)(n.span,{className:"token unchanged",children:[(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:" |- /node_modules"})]})]})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"src/globals.js"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsxs)(n.code,{className:"hljs language-js",children:[(0,a.jsx)(n.span,{className:"token keyword",children:"const"})," file ",(0,a.jsx)(n.span,{className:"token operator",children:"="})," ",(0,a.jsx)(n.span,{className:"token string",children:"'blah.txt'"}),(0,a.jsx)(n.span,{className:"token punctuation",children:";"}),"\n",(0,a.jsx)(n.span,{className:"token keyword",children:"const"})," helpers ",(0,a.jsx)(n.span,{className:"token operator",children:"="})," ",(0,a.jsx)(n.span,{className:"token punctuation",children:"{"}),"\n  ",(0,a.jsx)(n.span,{className:"token function-variable function",children:"test"}),(0,a.jsx)(n.span,{className:"token operator",children:":"})," ",(0,a.jsx)(n.span,{className:"token keyword",children:"function"})," ",(0,a.jsx)(n.span,{className:"token punctuation",children:"("}),(0,a.jsx)(n.span,{className:"token punctuation",children:")"})," ",(0,a.jsx)(n.span,{className:"token punctuation",children:"{"}),"\n    console",(0,a.jsx)(n.span,{className:"token punctuation",children:"."}),(0,a.jsx)(n.span,{className:"token function",children:"log"}),(0,a.jsx)(n.span,{className:"token punctuation",children:"("}),(0,a.jsx)(n.span,{className:"token string",children:"'test something'"}),(0,a.jsx)(n.span,{className:"token punctuation",children:")"}),(0,a.jsx)(n.span,{className:"token punctuation",children:";"}),"\n  ",(0,a.jsx)(n.span,{className:"token punctuation",children:"}"}),(0,a.jsx)(n.span,{className:"token punctuation",children:","}),"\n  ",(0,a.jsx)(n.span,{className:"token function-variable function",children:"parse"}),(0,a.jsx)(n.span,{className:"token operator",children:":"})," ",(0,a.jsx)(n.span,{className:"token keyword",children:"function"})," ",(0,a.jsx)(n.span,{className:"token punctuation",children:"("}),(0,a.jsx)(n.span,{className:"token punctuation",children:")"})," ",(0,a.jsx)(n.span,{className:"token punctuation",children:"{"}),"\n    console",(0,a.jsx)(n.span,{className:"token punctuation",children:"."}),(0,a.jsx)(n.span,{className:"token function",children:"log"}),(0,a.jsx)(n.span,{className:"token punctuation",children:"("}),(0,a.jsx)(n.span,{className:"token string",children:"'parse something'"}),(0,a.jsx)(n.span,{className:"token punctuation",children:")"}),(0,a.jsx)(n.span,{className:"token punctuation",children:";"}),"\n  ",(0,a.jsx)(n.span,{className:"token punctuation",children:"}"}),(0,a.jsx)(n.span,{className:"token punctuation",children:","}),"\n",(0,a.jsx)(n.span,{className:"token punctuation",children:"}"}),(0,a.jsx)(n.span,{className:"token punctuation",children:";"})]})}),"\n",(0,a.jsxs)(n.p,{children:["Now, while you'd likely never do this in your own source code, you may encounter a dated library you'd like to use that contains similar code to what's shown above. In this case, we can use ",(0,a.jsx)(n.a,{href:"/loaders/exports-loader/",children:(0,a.jsx)(n.code,{children:"exports-loader"})}),", to export that global variable as a normal module export. For instance, in order to export ",(0,a.jsx)(n.code,{children:"file"})," as ",(0,a.jsx)(n.code,{children:"file"})," and ",(0,a.jsx)(n.code,{children:"helpers.parse"})," as ",(0,a.jsx)(n.code,{children:"parse"}),":"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"webpack.config.js"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsxs)(n.code,{className:"hljs language-diff",children:[(0,a.jsxs)(n.span,{className:"token unchanged",children:[(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"const path = require('path');\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"const webpack = require('webpack');\n"})]}),"\n",(0,a.jsxs)(n.span,{className:"token unchanged",children:[(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"module.exports = {\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"  entry: './src/index.js',\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"  output: {\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"    filename: 'main.js',\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"    path: path.resolve(__dirname, 'dist'),\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"  },\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"  module: {\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"    rules: [\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"      {\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"        test: require.resolve('./src/index.js'),\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"        use: 'imports-loader?wrapper=window',\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"      },\n"})]}),(0,a.jsxs)(n.span,{className:"token inserted-sign inserted",children:[(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"      {\n"}),(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"        test: require.resolve('./src/globals.js'),\n"}),(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"        use:\n"}),(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"          'exports-loader?type=commonjs&exports=file,multiple|helpers.parse|parse',\n"}),(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"      },\n"})]}),(0,a.jsxs)(n.span,{className:"token unchanged",children:[(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"    ],\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"  },\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"  plugins: [\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"    new webpack.ProvidePlugin({\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"      join: ['lodash', 'join'],\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"    }),\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"  ],\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"};"})]})]})}),"\n",(0,a.jsxs)(n.p,{children:["Now from within our entry script (i.e. ",(0,a.jsx)(n.code,{children:"src/index.js"}),"), we could use ",(0,a.jsx)(n.code,{children:"const { file, parse } = require('./globals.js');"})," and all should work smoothly."]}),"\n",(0,a.jsxs)(n.h2,{children:[(0,a.jsx)(n.span,{id:"loading-polyfills"}),"Loading Polyfills",(0,a.jsx)(n.a,{href:"#loading-polyfills","aria-hidden":"true",tabIndex:"-1",children:(0,a.jsx)(n.span,{className:"header-link"})})]}),"\n",(0,a.jsxs)(n.p,{children:["Almost everything we've discussed thus far has been in relation to handling legacy packages. Let's move on to our second topic: ",(0,a.jsx)(n.strong,{children:"polyfills"}),"."]}),"\n",(0,a.jsxs)(n.p,{children:["There's a lot of ways to load polyfills. For example, to include the ",(0,a.jsx)(n.a,{href:"https://babeljs.io/docs/en/babel-polyfill/",children:(0,a.jsx)(n.code,{children:"babel-polyfill"})})," we might:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsxs)(n.code,{className:"hljs language-bash",children:[(0,a.jsx)(n.span,{className:"token function",children:"npm"})," ",(0,a.jsx)(n.span,{className:"token function",children:"install"})," --save babel-polyfill"]})}),"\n",(0,a.jsxs)(n.p,{children:["and ",(0,a.jsx)(n.code,{children:"import"})," it so as to include it in our main bundle:"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"src/index.js"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsxs)(n.code,{className:"hljs language-diff",children:[(0,a.jsxs)(n.span,{className:"token inserted-sign inserted",children:[(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"import 'babel-polyfill';\n"}),(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"\n"})]}),(0,a.jsxs)(n.span,{className:"token unchanged",children:[(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"function component() {\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"  const element = document.createElement('div');\n"})]}),"\n",(0,a.jsxs)(n.span,{className:"token unchanged",children:[(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"  element.innerHTML = join(['Hello', 'webpack'], ' ');\n"})]}),"\n",(0,a.jsxs)(n.span,{className:"token unchanged",children:[(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"  // Assume we are in the context of `window`\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:'  this.alert("Hmmm, this probably isn\'t a great idea...");\n'})]}),"\n",(0,a.jsxs)(n.span,{className:"token unchanged",children:[(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"  return element;\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"}\n"})]}),"\n",(0,a.jsxs)(n.span,{className:"token unchanged",children:[(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"document.body.appendChild(component());"})]})]})}),"\n",(0,a.jsxs)(n.aside,{className:"tip",children:[(0,a.jsx)(n.h6,{className:"tip__prefix",children:"tip"}),(0,a.jsxs)(n.p,{children:["Note that we aren't binding the ",(0,a.jsx)(n.code,{children:"import"})," to a variable. This is because polyfills run on their own, prior to the rest of the code base, allowing us to then assume certain native functionality exists."]})]}),"\n",(0,a.jsxs)(n.p,{children:["Note that this approach prioritizes correctness over bundle size. To be safe and robust, polyfills/shims must run ",(0,a.jsx)(n.strong,{children:"before all other code"}),', and thus either need to load synchronously, or, all app code needs to load after all polyfills/shims load.\nThere are many misconceptions in the community, as well, that modern browsers "don\'t need" polyfills, or that polyfills/shims merely serve to add missing features - in fact, they often ',(0,a.jsx)(n.em,{children:"repair broken implementations"}),", even in the most modern of browsers.\nThe best practice thus remains to unconditionally and synchronously load all polyfills/shims, despite the bundle size cost this incurs."]}),"\n",(0,a.jsxs)(n.p,{children:["If you feel that you have mitigated these concerns and wish to incur the risk of brokenness, here's one way you might do it:\nLet's move our ",(0,a.jsx)(n.code,{children:"import"})," to a new file and add the ",(0,a.jsx)(n.a,{href:"https://github.com/github/fetch",children:(0,a.jsx)(n.code,{children:"whatwg-fetch"})})," polyfill:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsxs)(n.code,{className:"hljs language-bash",children:[(0,a.jsx)(n.span,{className:"token function",children:"npm"})," ",(0,a.jsx)(n.span,{className:"token function",children:"install"})," --save whatwg-fetch"]})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"src/index.js"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsxs)(n.code,{className:"hljs language-diff",children:[(0,a.jsxs)(n.span,{className:"token deleted-sign deleted",children:[(0,a.jsx)(n.span,{className:"token prefix deleted",children:"-"}),(0,a.jsx)(n.span,{className:"token line",children:"import 'babel-polyfill';\n"}),(0,a.jsx)(n.span,{className:"token prefix deleted",children:"-"}),(0,a.jsx)(n.span,{className:"token line",children:"\n"})]}),(0,a.jsxs)(n.span,{className:"token unchanged",children:[(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"function component() {\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"  const element = document.createElement('div');\n"})]}),"\n",(0,a.jsxs)(n.span,{className:"token unchanged",children:[(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"  element.innerHTML = join(['Hello', 'webpack'], ' ');\n"})]}),"\n",(0,a.jsxs)(n.span,{className:"token unchanged",children:[(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"  // Assume we are in the context of `window`\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:'  this.alert("Hmmm, this probably isn\'t a great idea...");\n'})]}),"\n",(0,a.jsxs)(n.span,{className:"token unchanged",children:[(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"  return element;\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"}\n"})]}),"\n",(0,a.jsxs)(n.span,{className:"token unchanged",children:[(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"document.body.appendChild(component());"})]})]})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"project"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsxs)(n.code,{className:"hljs language-diff",children:[(0,a.jsxs)(n.span,{className:"token unchanged",children:[(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:" webpack-demo\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:" |- package.json\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:" |- package-lock.json\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:" |- webpack.config.js\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:" |- /dist\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:" |- /src\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"   |- index.js\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"   |- globals.js\n"})]}),(0,a.jsxs)(n.span,{className:"token inserted-sign inserted",children:[(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"   |- polyfills.js\n"})]}),(0,a.jsxs)(n.span,{className:"token unchanged",children:[(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:" |- /node_modules"})]})]})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"src/polyfills.js"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsxs)(n.code,{className:"hljs language-javascript",children:[(0,a.jsx)(n.span,{className:"token keyword",children:"import"})," ",(0,a.jsx)(n.span,{className:"token string",children:"'babel-polyfill'"}),(0,a.jsx)(n.span,{className:"token punctuation",children:";"}),"\n",(0,a.jsx)(n.span,{className:"token keyword",children:"import"})," ",(0,a.jsx)(n.span,{className:"token string",children:"'whatwg-fetch'"}),(0,a.jsx)(n.span,{className:"token punctuation",children:";"})]})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"webpack.config.js"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsxs)(n.code,{className:"hljs language-diff",children:[(0,a.jsxs)(n.span,{className:"token unchanged",children:[(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"const path = require('path');\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"const webpack = require('webpack');\n"})]}),"\n",(0,a.jsxs)(n.span,{className:"token unchanged",children:[(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"module.exports = {\n"})]}),(0,a.jsxs)(n.span,{className:"token deleted-sign deleted",children:[(0,a.jsx)(n.span,{className:"token prefix deleted",children:"-"}),(0,a.jsx)(n.span,{className:"token line",children:"  entry: './src/index.js',\n"})]}),(0,a.jsxs)(n.span,{className:"token inserted-sign inserted",children:[(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"  entry: {\n"}),(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"    polyfills: './src/polyfills',\n"}),(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"    index: './src/index.js',\n"}),(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"  },\n"})]}),(0,a.jsxs)(n.span,{className:"token unchanged",children:[(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"  output: {\n"})]}),(0,a.jsxs)(n.span,{className:"token deleted-sign deleted",children:[(0,a.jsx)(n.span,{className:"token prefix deleted",children:"-"}),(0,a.jsx)(n.span,{className:"token line",children:"    filename: 'main.js',\n"})]}),(0,a.jsxs)(n.span,{className:"token inserted-sign inserted",children:[(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"    filename: '[name].bundle.js',\n"})]}),(0,a.jsxs)(n.span,{className:"token unchanged",children:[(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"    path: path.resolve(__dirname, 'dist'),\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"  },\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"  module: {\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"    rules: [\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"      {\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"        test: require.resolve('./src/index.js'),\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"        use: 'imports-loader?wrapper=window',\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"      },\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"      {\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"        test: require.resolve('./src/globals.js'),\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"        use:\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"          'exports-loader?type=commonjs&exports[]=file&exports[]=multiple|helpers.parse|parse',\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"      },\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"    ],\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"  },\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"  plugins: [\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"    new webpack.ProvidePlugin({\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"      join: ['lodash', 'join'],\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"    }),\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"  ],\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"};"})]})]})}),"\n",(0,a.jsxs)(n.p,{children:["With that in place, we can add the logic to conditionally load our new ",(0,a.jsx)(n.code,{children:"polyfills.bundle.js"})," file. How you make this decision depends on the technologies and browsers you need to support. We'll do some testing to determine whether our polyfills are needed:"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"dist/index.html"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsxs)(n.code,{className:"hljs language-diff",children:[(0,a.jsxs)(n.span,{className:"token unchanged",children:[(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"<!DOCTYPE html>\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"<html>\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"  <head>\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:'    <meta charset="utf-8" />\n'}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"    <title>Getting Started</title>\n"})]}),(0,a.jsxs)(n.span,{className:"token inserted-sign inserted",children:[(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"    <script>\n"}),(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"      const modernBrowser = 'fetch' in window && 'assign' in Object;\n"}),(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"\n"}),(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"      if (!modernBrowser) {\n"}),(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"        const scriptElement = document.createElement('script');\n"}),(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"\n"}),(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"        scriptElement.async = false;\n"}),(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"        scriptElement.src = '/polyfills.bundle.js';\n"}),(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"        document.head.appendChild(scriptElement);\n"}),(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"      }\n"}),(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"    <\/script>\n"})]}),(0,a.jsxs)(n.span,{className:"token unchanged",children:[(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"  </head>\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"  <body>\n"})]}),(0,a.jsxs)(n.span,{className:"token deleted-sign deleted",children:[(0,a.jsx)(n.span,{className:"token prefix deleted",children:"-"}),(0,a.jsx)(n.span,{className:"token line",children:'    <script src="main.js"><\/script>\n'})]}),(0,a.jsxs)(n.span,{className:"token inserted-sign inserted",children:[(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:'    <script src="index.bundle.js"><\/script>\n'})]}),(0,a.jsxs)(n.span,{className:"token unchanged",children:[(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"  </body>\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"</html>"})]})]})}),"\n",(0,a.jsxs)(n.p,{children:["Now we can ",(0,a.jsx)(n.code,{children:"fetch"})," some data within our entry script:"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"src/index.js"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsxs)(n.code,{className:"hljs language-diff",children:[(0,a.jsxs)(n.span,{className:"token unchanged",children:[(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"function component() {\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"  const element = document.createElement('div');\n"})]}),"\n",(0,a.jsxs)(n.span,{className:"token unchanged",children:[(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"  element.innerHTML = join(['Hello', 'webpack'], ' ');\n"})]}),"\n",(0,a.jsxs)(n.span,{className:"token unchanged",children:[(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"  // Assume we are in the context of `window`\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:'  this.alert("Hmmm, this probably isn\'t a great idea...");\n'})]}),"\n",(0,a.jsxs)(n.span,{className:"token unchanged",children:[(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"  return element;\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"}\n"})]}),"\n",(0,a.jsxs)(n.span,{className:"token unchanged",children:[(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"document.body.appendChild(component());\n"})]}),(0,a.jsxs)(n.span,{className:"token inserted-sign inserted",children:[(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"\n"}),(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"fetch('https://jsonplaceholder.typicode.com/users')\n"}),(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"  .then((response) => response.json())\n"}),(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"  .then((json) => {\n"}),(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"    console.log(\n"}),(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:'      "We retrieved some data! AND we\'re confident it will work on a variety of browser distributions."\n'}),(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"    );\n"}),(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"    console.log(json);\n"}),(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"  })\n"}),(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"  .catch((error) =>\n"}),(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"    console.error('Something went wrong when fetching this data: ', error)\n"}),(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"  );"})]})]})}),"\n",(0,a.jsxs)(n.p,{children:["If we run our build, another ",(0,a.jsx)(n.code,{children:"polyfills.bundle.js"})," file will be emitted and everything should still run smoothly in the browser. Note that this set up could likely be improved upon but it should give you a good idea of how you can provide polyfills only to the users that actually need them."]}),"\n",(0,a.jsxs)(n.h2,{children:[(0,a.jsx)(n.span,{id:"further-optimizations"}),"Further Optimizations",(0,a.jsx)(n.a,{href:"#further-optimizations","aria-hidden":"true",tabIndex:"-1",children:(0,a.jsx)(n.span,{className:"header-link"})})]}),"\n",(0,a.jsxs)(n.p,{children:["The ",(0,a.jsx)(n.code,{children:"babel-preset-env"})," package uses ",(0,a.jsx)(n.a,{href:"https://github.com/browserslist/browserslist",children:"browserslist"})," to transpile only what is not supported in your browsers matrix. This preset comes with the ",(0,a.jsx)(n.a,{href:"https://babeljs.io/docs/en/babel-preset-env#usebuiltins",children:(0,a.jsx)(n.code,{children:"useBuiltIns"})})," option, ",(0,a.jsx)(n.code,{children:"false"})," by default, which converts your global ",(0,a.jsx)(n.code,{children:"babel-polyfill"})," import to a more granular feature by feature ",(0,a.jsx)(n.code,{children:"import"})," pattern:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsxs)(n.code,{className:"hljs language-js",children:[(0,a.jsx)(n.span,{className:"token keyword",children:"import"})," ",(0,a.jsx)(n.span,{className:"token string",children:"'core-js/modules/es7.string.pad-start'"}),(0,a.jsx)(n.span,{className:"token punctuation",children:";"}),"\n",(0,a.jsx)(n.span,{className:"token keyword",children:"import"})," ",(0,a.jsx)(n.span,{className:"token string",children:"'core-js/modules/es7.string.pad-end'"}),(0,a.jsx)(n.span,{className:"token punctuation",children:";"}),"\n",(0,a.jsx)(n.span,{className:"token keyword",children:"import"})," ",(0,a.jsx)(n.span,{className:"token string",children:"'core-js/modules/web.timers'"}),(0,a.jsx)(n.span,{className:"token punctuation",children:";"}),"\n",(0,a.jsx)(n.span,{className:"token keyword",children:"import"})," ",(0,a.jsx)(n.span,{className:"token string",children:"'core-js/modules/web.immediate'"}),(0,a.jsx)(n.span,{className:"token punctuation",children:";"}),"\n",(0,a.jsx)(n.span,{className:"token keyword",children:"import"})," ",(0,a.jsx)(n.span,{className:"token string",children:"'core-js/modules/web.dom.iterable'"}),(0,a.jsx)(n.span,{className:"token punctuation",children:";"})]})}),"\n",(0,a.jsxs)(n.p,{children:["See ",(0,a.jsx)(n.a,{href:"https://babeljs.io/docs/en/babel-preset-env",children:"the babel-preset-env documentation"})," for more information."]}),"\n",(0,a.jsxs)(n.h2,{children:[(0,a.jsx)(n.span,{id:"node-built-ins"}),"Node Built-Ins",(0,a.jsx)(n.a,{href:"#node-built-ins","aria-hidden":"true",tabIndex:"-1",children:(0,a.jsx)(n.span,{className:"header-link"})})]}),"\n",(0,a.jsxs)(n.p,{children:["Node built-ins, like ",(0,a.jsx)(n.code,{children:"process"}),", can be polyfilled right directly from your configuration file without the use of any special loaders or plugins. See the ",(0,a.jsx)(n.a,{href:"/configuration/node",children:"node configuration page"})," for more information and examples."]}),"\n",(0,a.jsxs)(n.h2,{children:[(0,a.jsx)(n.span,{id:"other-utilities"}),"Other Utilities",(0,a.jsx)(n.a,{href:"#other-utilities","aria-hidden":"true",tabIndex:"-1",children:(0,a.jsx)(n.span,{className:"header-link"})})]}),"\n",(0,a.jsx)(n.p,{children:"There are a few other tools that can help when dealing with legacy modules."}),"\n",(0,a.jsxs)(n.p,{children:["When there is no AMD/CommonJS version of the module and you want to include the ",(0,a.jsx)(n.code,{children:"dist"}),", you can flag this module in ",(0,a.jsx)(n.a,{href:"/configuration/module/#modulenoparse",children:(0,a.jsx)(n.code,{children:"noParse"})}),". This will cause webpack to include the module without parsing it or resolving ",(0,a.jsx)(n.code,{children:"require()"})," and ",(0,a.jsx)(n.code,{children:"import"})," statements. This practice is also used to improve the build performance."]}),"\n",(0,a.jsxs)(n.aside,{className:"warning",children:[(0,a.jsx)(n.h6,{className:"warning__prefix",children:"warning"}),(0,a.jsxs)(n.p,{children:["Any feature requiring the AST, like the ",(0,a.jsx)(n.code,{children:"ProvidePlugin"}),", will not work."]})]}),"\n",(0,a.jsxs)(n.p,{children:["Lastly, there are some modules that support multiple ",(0,a.jsx)(n.a,{href:"/concepts/modules",children:"module styles"}),"; e.g. a combination of AMD, CommonJS, and legacy. In most of these cases, they first check for ",(0,a.jsx)(n.code,{children:"define"})," and then use some quirky code to export properties. In these cases, it could help to force the CommonJS path by setting ",(0,a.jsx)(n.code,{children:"additionalCode=var%20define%20=%20false;"})," via the ",(0,a.jsx)(n.a,{href:"/loaders/imports-loader/",children:(0,a.jsx)(n.code,{children:"imports-loader"})}),"."]})]})}function c(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(i,{...e})}):i(e)}}}]);