"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[5190],{5190:function(e,n,s){s.r(n),s.d(n,{default:function(){return i}});var a=s(2540),t=s(3317);function c(e){const n={a:"a",aside:"aside",code:"code",h2:"h2",h3:"h3",h6:"h6",p:"p",pre:"pre",span:"span",strong:"strong",...(0,t.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(n.p,{children:["The ",(0,a.jsx)(n.a,{href:"/configuration/output/#outputpublicpath",children:(0,a.jsx)(n.code,{children:"publicPath"})})," configuration option can be quite useful in a variety of scenarios. It allows you to specify the base path for all the assets within your application."]}),"\n",(0,a.jsxs)(n.h2,{children:[(0,a.jsx)(n.span,{id:"use-cases"}),"Use Cases",(0,a.jsx)(n.a,{href:"#use-cases","aria-hidden":"true",tabIndex:"-1",children:(0,a.jsx)(n.span,{className:"header-link"})})]}),"\n",(0,a.jsxs)(n.p,{children:["There are a few use cases in real applications where this feature becomes especially neat. Essentially, every file emitted to your ",(0,a.jsx)(n.code,{children:"output.path"})," directory will be referenced from the ",(0,a.jsx)(n.code,{children:"output.publicPath"})," location. This includes child chunks (created via ",(0,a.jsx)(n.a,{href:"/guides/code-splitting/",children:"code splitting"}),") and any other assets (e.g. images, fonts, etc.) that are a part of your dependency graph."]}),"\n",(0,a.jsxs)(n.h3,{children:[(0,a.jsx)(n.span,{id:"environment-based"}),"Environment Based",(0,a.jsx)(n.a,{href:"#environment-based","aria-hidden":"true",tabIndex:"-1",children:(0,a.jsx)(n.span,{className:"header-link"})})]}),"\n",(0,a.jsxs)(n.p,{children:["In development for example, we might have an ",(0,a.jsx)(n.code,{children:"assets/"})," folder that lives on the same level of our index page. This is fine, but what if we wanted to host all these static assets on a CDN in production?"]}),"\n",(0,a.jsxs)(n.p,{children:["To approach this problem you can easily use a good old environment variable. Let's say we have a variable ",(0,a.jsx)(n.code,{children:"ASSET_PATH"}),":"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsxs)(n.code,{className:"hljs language-js",children:[(0,a.jsx)(n.span,{className:"token keyword",children:"import"})," webpack ",(0,a.jsx)(n.span,{className:"token keyword",children:"from"})," ",(0,a.jsx)(n.span,{className:"token string",children:"'webpack'"}),(0,a.jsx)(n.span,{className:"token punctuation",children:";"}),"\n\n",(0,a.jsx)(n.span,{className:"token comment",children:"// Try the environment variable, otherwise use root"}),"\n",(0,a.jsx)(n.span,{className:"token keyword",children:"const"})," ",(0,a.jsx)(n.span,{className:"token constant",children:"ASSET_PATH"})," ",(0,a.jsx)(n.span,{className:"token operator",children:"="})," process",(0,a.jsx)(n.span,{className:"token punctuation",children:"."}),"env",(0,a.jsx)(n.span,{className:"token punctuation",children:"."}),(0,a.jsx)(n.span,{className:"token constant",children:"ASSET_PATH"})," ",(0,a.jsx)(n.span,{className:"token operator",children:"||"})," ",(0,a.jsx)(n.span,{className:"token string",children:"'/'"}),(0,a.jsx)(n.span,{className:"token punctuation",children:";"}),"\n\n",(0,a.jsx)(n.span,{className:"token keyword",children:"export"})," ",(0,a.jsx)(n.span,{className:"token keyword",children:"default"})," ",(0,a.jsx)(n.span,{className:"token punctuation",children:"{"}),"\n  output",(0,a.jsx)(n.span,{className:"token operator",children:":"})," ",(0,a.jsx)(n.span,{className:"token punctuation",children:"{"}),"\n    publicPath",(0,a.jsx)(n.span,{className:"token operator",children:":"})," ",(0,a.jsx)(n.span,{className:"token constant",children:"ASSET_PATH"}),(0,a.jsx)(n.span,{className:"token punctuation",children:","}),"\n  ",(0,a.jsx)(n.span,{className:"token punctuation",children:"}"}),(0,a.jsx)(n.span,{className:"token punctuation",children:","}),"\n\n  plugins",(0,a.jsx)(n.span,{className:"token operator",children:":"})," ",(0,a.jsx)(n.span,{className:"token punctuation",children:"["}),"\n    ",(0,a.jsx)(n.span,{className:"token comment",children:"// This makes it possible for us to safely use env vars on our code"}),"\n    ",(0,a.jsx)(n.span,{className:"token keyword",children:"new"})," ",(0,a.jsxs)(n.span,{className:"token class-name",children:["webpack",(0,a.jsx)(n.span,{className:"token punctuation",children:"."}),"DefinePlugin"]}),(0,a.jsx)(n.span,{className:"token punctuation",children:"("}),(0,a.jsx)(n.span,{className:"token punctuation",children:"{"}),"\n      ",(0,a.jsx)(n.span,{className:"token string",children:"'process.env.ASSET_PATH'"}),(0,a.jsx)(n.span,{className:"token operator",children:":"})," ",(0,a.jsx)(n.span,{className:"token constant",children:"JSON"}),(0,a.jsx)(n.span,{className:"token punctuation",children:"."}),(0,a.jsx)(n.span,{className:"token function",children:"stringify"}),(0,a.jsx)(n.span,{className:"token punctuation",children:"("}),(0,a.jsx)(n.span,{className:"token constant",children:"ASSET_PATH"}),(0,a.jsx)(n.span,{className:"token punctuation",children:")"}),(0,a.jsx)(n.span,{className:"token punctuation",children:","}),"\n    ",(0,a.jsx)(n.span,{className:"token punctuation",children:"}"}),(0,a.jsx)(n.span,{className:"token punctuation",children:")"}),(0,a.jsx)(n.span,{className:"token punctuation",children:","}),"\n  ",(0,a.jsx)(n.span,{className:"token punctuation",children:"]"}),(0,a.jsx)(n.span,{className:"token punctuation",children:","}),"\n",(0,a.jsx)(n.span,{className:"token punctuation",children:"}"}),(0,a.jsx)(n.span,{className:"token punctuation",children:";"})]})}),"\n",(0,a.jsxs)(n.h3,{children:[(0,a.jsx)(n.span,{id:"on-the-fly"}),"On The Fly",(0,a.jsx)(n.a,{href:"#on-the-fly","aria-hidden":"true",tabIndex:"-1",children:(0,a.jsx)(n.span,{className:"header-link"})})]}),"\n",(0,a.jsxs)(n.p,{children:["Another possible use case is to set the ",(0,a.jsx)(n.code,{children:"publicPath"})," on the fly. Webpack exposes a global variable called ",(0,a.jsx)(n.code,{children:"__webpack_public_path__"})," that allows you to do that. In your application's entry point, you can do this:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsxs)(n.code,{className:"hljs language-js",children:["__webpack_public_path__ ",(0,a.jsx)(n.span,{className:"token operator",children:"="})," process",(0,a.jsx)(n.span,{className:"token punctuation",children:"."}),"env",(0,a.jsx)(n.span,{className:"token punctuation",children:"."}),(0,a.jsx)(n.span,{className:"token constant",children:"ASSET_PATH"}),(0,a.jsx)(n.span,{className:"token punctuation",children:";"})]})}),"\n",(0,a.jsxs)(n.p,{children:["That's all you need. Since we're already using the ",(0,a.jsx)(n.code,{children:"DefinePlugin"})," on our\nconfiguration, ",(0,a.jsx)(n.code,{children:"process.env.ASSET_PATH"})," will always be defined so we can safely\ndo that."]}),"\n",(0,a.jsxs)(n.aside,{className:"warning",children:[(0,a.jsx)(n.h6,{className:"warning__prefix",children:"warning"}),(0,a.jsxs)(n.p,{children:["Be aware that if you use ES6 module imports in your entry file the ",(0,a.jsx)(n.code,{children:"__webpack_public_path__"})," assignment will be done after the imports. In such cases, you'll have to move the public path assignment to its own dedicated module and then import it on top of your entry.js:"]})]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsxs)(n.code,{className:"hljs language-js",children:[(0,a.jsx)(n.span,{className:"token comment",children:"// entry.js"}),"\n",(0,a.jsx)(n.span,{className:"token keyword",children:"import"})," ",(0,a.jsx)(n.span,{className:"token string",children:"'./public-path'"}),(0,a.jsx)(n.span,{className:"token punctuation",children:";"}),"\n",(0,a.jsx)(n.span,{className:"token keyword",children:"import"})," ",(0,a.jsx)(n.span,{className:"token string",children:"'./app'"}),(0,a.jsx)(n.span,{className:"token punctuation",children:";"})]})}),"\n",(0,a.jsxs)(n.h3,{children:[(0,a.jsx)(n.span,{id:"automatic-publicpath"}),"Automatic publicPath",(0,a.jsx)(n.a,{href:"#automatic-publicpath","aria-hidden":"true",tabIndex:"-1",children:(0,a.jsx)(n.span,{className:"header-link"})})]}),"\n",(0,a.jsxs)(n.p,{children:["There are chances that you don't know what the publicPath will be in advance, and webpack can handle it automatically for you by determining the public path from variables like ",(0,a.jsx)(n.a,{href:"/api/module-variables/#importmetaurl",children:(0,a.jsx)(n.code,{children:"import.meta.url"})}),", ",(0,a.jsx)(n.a,{href:"https://developer.mozilla.org/en-US/docs/Web/API/Document/currentScript",children:(0,a.jsx)(n.code,{children:"document.currentScript"})}),", ",(0,a.jsx)(n.code,{children:"script.src"})," or ",(0,a.jsx)(n.code,{children:"self.location"}),". What you need is to set ",(0,a.jsx)(n.a,{href:"/configuration/output/#outputpublicpath",children:(0,a.jsx)(n.code,{children:"output.publicPath"})})," to ",(0,a.jsx)(n.code,{children:"'auto'"}),":"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"webpack.config.js"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsxs)(n.code,{className:"hljs language-js",children:["module",(0,a.jsx)(n.span,{className:"token punctuation",children:"."}),"exports ",(0,a.jsx)(n.span,{className:"token operator",children:"="})," ",(0,a.jsx)(n.span,{className:"token punctuation",children:"{"}),"\n  output",(0,a.jsx)(n.span,{className:"token operator",children:":"})," ",(0,a.jsx)(n.span,{className:"token punctuation",children:"{"}),"\n    publicPath",(0,a.jsx)(n.span,{className:"token operator",children:":"})," ",(0,a.jsx)(n.span,{className:"token string",children:"'auto'"}),(0,a.jsx)(n.span,{className:"token punctuation",children:","}),"\n  ",(0,a.jsx)(n.span,{className:"token punctuation",children:"}"}),(0,a.jsx)(n.span,{className:"token punctuation",children:","}),"\n",(0,a.jsx)(n.span,{className:"token punctuation",children:"}"}),(0,a.jsx)(n.span,{className:"token punctuation",children:";"})]})}),"\n",(0,a.jsxs)(n.p,{children:["Note that in cases where ",(0,a.jsx)(n.code,{children:"document.currentScript"})," is not supported, e.g., IE browser, you will have to include a polyfill like ",(0,a.jsx)(n.a,{href:"https://github.com/amiller-gh/currentScript-polyfill",children:(0,a.jsx)(n.code,{children:"currentScript Polyfill"})}),"."]})]})}function i(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}}}]);