"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[6688],{6688:function(e,s,n){n.r(s),n.d(s,{default:function(){return l}});var a=n(2540),c=n(3317);function t(e){const s={a:"a",code:"code",h2:"h2",p:"p",pre:"pre",span:"span",...(0,c.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(s.p,{children:["If you have a more advanced project and use ",(0,a.jsx)(s.a,{href:"https://www.vagrantup.com/",children:"Vagrant"})," to run your development environment in a Virtual Machine, you'll often want to also run webpack in the VM."]}),"\n",(0,a.jsxs)(s.h2,{children:[(0,a.jsx)(s.span,{id:"configuring-the-project"}),"Configuring the Project",(0,a.jsx)(s.a,{href:"#configuring-the-project","aria-hidden":"true",tabIndex:"-1",children:(0,a.jsx)(s.span,{className:"header-link"})})]}),"\n",(0,a.jsxs)(s.p,{children:["To start, make sure that the ",(0,a.jsx)(s.code,{children:"Vagrantfile"})," has a static IP;"]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsxs)(s.code,{className:"hljs language-ruby",children:[(0,a.jsx)(s.span,{className:"token constant",children:"Vagrant"}),(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"configure",(0,a.jsx)(s.span,{className:"token punctuation",children:"("}),(0,a.jsx)(s.span,{className:"token string",children:'"2"'}),(0,a.jsx)(s.span,{className:"token punctuation",children:")"})," ",(0,a.jsx)(s.span,{className:"token keyword",children:"do"})," ",(0,a.jsx)(s.span,{className:"token operator",children:"|"}),"config",(0,a.jsx)(s.span,{className:"token operator",children:"|"}),"\n  config",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"vm",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"network ",(0,a.jsx)(s.span,{className:"token symbol",children:":private_network"}),(0,a.jsx)(s.span,{className:"token punctuation",children:","})," ip",(0,a.jsx)(s.span,{className:"token punctuation",children:":"})," ",(0,a.jsx)(s.span,{className:"token string",children:'"10.10.10.61"'}),"\n",(0,a.jsx)(s.span,{className:"token keyword",children:"end"})]})}),"\n",(0,a.jsxs)(s.p,{children:["Next, install ",(0,a.jsx)(s.code,{children:"webpack"}),", ",(0,a.jsx)(s.code,{children:"webpack-cli"}),", ",(0,a.jsx)(s.code,{children:"@webpack-cli/serve"}),", and ",(0,a.jsx)(s.code,{children:"webpack-dev-server"})," in your project;"]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsxs)(s.code,{className:"hljs language-bash",children:[(0,a.jsx)(s.span,{className:"token function",children:"npm"})," ",(0,a.jsx)(s.span,{className:"token function",children:"install"})," --save-dev webpack webpack-cli @webpack-cli/serve webpack-dev-server"]})}),"\n",(0,a.jsxs)(s.p,{children:["Make sure to have a ",(0,a.jsx)(s.code,{children:"webpack.config.js"})," file. If you haven't already, use this as a minimal example to get started:"]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsxs)(s.code,{className:"hljs language-js",children:["module",(0,a.jsx)(s.span,{className:"token punctuation",children:"."}),"exports ",(0,a.jsx)(s.span,{className:"token operator",children:"="})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"{"}),"\n  context",(0,a.jsx)(s.span,{className:"token operator",children:":"})," __dirname",(0,a.jsx)(s.span,{className:"token punctuation",children:","}),"\n  entry",(0,a.jsx)(s.span,{className:"token operator",children:":"})," ",(0,a.jsx)(s.span,{className:"token string",children:"'./app.js'"}),(0,a.jsx)(s.span,{className:"token punctuation",children:","}),"\n",(0,a.jsx)(s.span,{className:"token punctuation",children:"}"}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"})]})}),"\n",(0,a.jsxs)(s.p,{children:["And create an ",(0,a.jsx)(s.code,{children:"index.html"})," file. The script tag should point to your bundle. If ",(0,a.jsx)(s.code,{children:"output.filename"})," is not specified in the config, this will be ",(0,a.jsx)(s.code,{children:"bundle.js"}),"."]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsxs)(s.code,{className:"hljs language-html",children:[(0,a.jsxs)(s.span,{className:"token doctype",children:[(0,a.jsx)(s.span,{className:"token punctuation",children:"<!"}),(0,a.jsx)(s.span,{className:"token doctype-tag",children:"DOCTYPE"})," ",(0,a.jsx)(s.span,{className:"token name",children:"html"}),(0,a.jsx)(s.span,{className:"token punctuation",children:">"})]}),"\n",(0,a.jsxs)(s.span,{className:"token tag",children:[(0,a.jsxs)(s.span,{className:"token tag",children:[(0,a.jsx)(s.span,{className:"token punctuation",children:"<"}),"html"]}),(0,a.jsx)(s.span,{className:"token punctuation",children:">"})]}),"\n  ",(0,a.jsxs)(s.span,{className:"token tag",children:[(0,a.jsxs)(s.span,{className:"token tag",children:[(0,a.jsx)(s.span,{className:"token punctuation",children:"<"}),"head"]}),(0,a.jsx)(s.span,{className:"token punctuation",children:">"})]}),"\n    ",(0,a.jsxs)(s.span,{className:"token tag",children:[(0,a.jsxs)(s.span,{className:"token tag",children:[(0,a.jsx)(s.span,{className:"token punctuation",children:"<"}),"script"]})," ",(0,a.jsx)(s.span,{className:"token attr-name",children:"src"}),(0,a.jsxs)(s.span,{className:"token attr-value",children:[(0,a.jsx)(s.span,{className:"token punctuation attr-equals",children:"="}),(0,a.jsx)(s.span,{className:"token punctuation",children:'"'}),"/bundle.js",(0,a.jsx)(s.span,{className:"token punctuation",children:'"'})]})," ",(0,a.jsx)(s.span,{className:"token attr-name",children:"charset"}),(0,a.jsxs)(s.span,{className:"token attr-value",children:[(0,a.jsx)(s.span,{className:"token punctuation attr-equals",children:"="}),(0,a.jsx)(s.span,{className:"token punctuation",children:'"'}),"utf-8",(0,a.jsx)(s.span,{className:"token punctuation",children:'"'})]}),(0,a.jsx)(s.span,{className:"token punctuation",children:">"})]}),(0,a.jsx)(s.span,{className:"token script"}),(0,a.jsxs)(s.span,{className:"token tag",children:[(0,a.jsxs)(s.span,{className:"token tag",children:[(0,a.jsx)(s.span,{className:"token punctuation",children:"</"}),"script"]}),(0,a.jsx)(s.span,{className:"token punctuation",children:">"})]}),"\n  ",(0,a.jsxs)(s.span,{className:"token tag",children:[(0,a.jsxs)(s.span,{className:"token tag",children:[(0,a.jsx)(s.span,{className:"token punctuation",children:"</"}),"head"]}),(0,a.jsx)(s.span,{className:"token punctuation",children:">"})]}),"\n  ",(0,a.jsxs)(s.span,{className:"token tag",children:[(0,a.jsxs)(s.span,{className:"token tag",children:[(0,a.jsx)(s.span,{className:"token punctuation",children:"<"}),"body"]}),(0,a.jsx)(s.span,{className:"token punctuation",children:">"})]}),"\n    ",(0,a.jsxs)(s.span,{className:"token tag",children:[(0,a.jsxs)(s.span,{className:"token tag",children:[(0,a.jsx)(s.span,{className:"token punctuation",children:"<"}),"h2"]}),(0,a.jsx)(s.span,{className:"token punctuation",children:">"})]}),"Hey!",(0,a.jsxs)(s.span,{className:"token tag",children:[(0,a.jsxs)(s.span,{className:"token tag",children:[(0,a.jsx)(s.span,{className:"token punctuation",children:"</"}),"h2"]}),(0,a.jsx)(s.span,{className:"token punctuation",children:">"})]}),"\n  ",(0,a.jsxs)(s.span,{className:"token tag",children:[(0,a.jsxs)(s.span,{className:"token tag",children:[(0,a.jsx)(s.span,{className:"token punctuation",children:"</"}),"body"]}),(0,a.jsx)(s.span,{className:"token punctuation",children:">"})]}),"\n",(0,a.jsxs)(s.span,{className:"token tag",children:[(0,a.jsxs)(s.span,{className:"token tag",children:[(0,a.jsx)(s.span,{className:"token punctuation",children:"</"}),"html"]}),(0,a.jsx)(s.span,{className:"token punctuation",children:">"})]})]})}),"\n",(0,a.jsxs)(s.p,{children:["Note that you also need to create an ",(0,a.jsx)(s.code,{children:"app.js"})," file."]}),"\n",(0,a.jsxs)(s.h2,{children:[(0,a.jsx)(s.span,{id:"running-the-server"}),"Running the Server",(0,a.jsx)(s.a,{href:"#running-the-server","aria-hidden":"true",tabIndex:"-1",children:(0,a.jsx)(s.span,{className:"header-link"})})]}),"\n",(0,a.jsx)(s.p,{children:"Now, let's run the server:"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsxs)(s.code,{className:"hljs language-bash",children:["webpack serve --host ",(0,a.jsx)(s.span,{className:"token number",children:"0.0"}),".0.0 --client-web-socket-url ws://10.10.10.61:8080/ws --watch-options-poll"]})}),"\n",(0,a.jsxs)(s.p,{children:["By default, the server will only be accessible from localhost. We'll be accessing it from our host PC, so we need to change ",(0,a.jsx)(s.code,{children:"--host"})," to allow this."]}),"\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.code,{children:"webpack-dev-server"})," will include a script in your bundle that connects to a WebSocket to reload when a change in any of your files occurs.\nThe ",(0,a.jsx)(s.code,{children:"--client-web-socket-url"})," flag makes sure the script knows where to look for the WebSocket. The server will use port ",(0,a.jsx)(s.code,{children:"8080"})," by default, so we should also specify that here."]}),"\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.code,{children:"--watch-options-poll"})," makes sure that webpack can detect changes in your files. By default, webpack listens to events triggered by the filesystem, but VirtualBox has many problems with this."]}),"\n",(0,a.jsxs)(s.p,{children:["The server should be accessible on ",(0,a.jsx)(s.code,{children:"http://10.10.10.61:8080"})," now. If you make a change in ",(0,a.jsx)(s.code,{children:"app.js"}),", it should live reload."]}),"\n",(0,a.jsxs)(s.h2,{children:[(0,a.jsx)(s.span,{id:"advanced-usage-with-nginx"}),"Advanced Usage with nginx",(0,a.jsx)(s.a,{href:"#advanced-usage-with-nginx","aria-hidden":"true",tabIndex:"-1",children:(0,a.jsx)(s.span,{className:"header-link"})})]}),"\n",(0,a.jsxs)(s.p,{children:["To mimic a more production-like environment, it is also possible to proxy the ",(0,a.jsx)(s.code,{children:"webpack-dev-server"})," with nginx."]}),"\n",(0,a.jsx)(s.p,{children:"In your nginx configuration file, add the following:"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsxs)(s.code,{className:"hljs language-nginx",children:[(0,a.jsx)(s.span,{className:"token keyword",children:"server"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"{"}),"\n  ",(0,a.jsx)(s.span,{className:"token keyword",children:"location"})," ",(0,a.jsx)(s.span,{className:"token operator",children:"/"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"{"}),"\n    ",(0,a.jsx)(s.span,{className:"token keyword",children:"proxy_pass"})," ",(0,a.jsx)(s.span,{className:"token keyword",children:"http"}),(0,a.jsx)(s.span,{className:"token punctuation",children:":"}),(0,a.jsx)(s.span,{className:"token operator",children:"/"}),(0,a.jsx)(s.span,{className:"token operator",children:"/"}),(0,a.jsx)(s.span,{className:"token number",children:"127.0"}),(0,a.jsx)(s.span,{className:"token number",children:".0"}),(0,a.jsx)(s.span,{className:"token number",children:".1"}),(0,a.jsx)(s.span,{className:"token punctuation",children:":"}),(0,a.jsx)(s.span,{className:"token number",children:"8080"}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n    ",(0,a.jsx)(s.span,{className:"token keyword",children:"proxy_http_version"})," ",(0,a.jsx)(s.span,{className:"token number",children:"1.1"}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n    ",(0,a.jsx)(s.span,{className:"token keyword",children:"proxy_set_header"})," Upgrade ",(0,a.jsx)(s.span,{className:"token variable",children:"$http_upgrade"}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n    ",(0,a.jsx)(s.span,{className:"token keyword",children:"proxy_set_header"})," Connection ",(0,a.jsx)(s.span,{className:"token string",children:'"upgrade"'}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n    ",(0,a.jsx)(s.span,{className:"token keyword",children:"error_page"})," ",(0,a.jsx)(s.span,{className:"token number",children:"502"})," @start",(0,a.jsx)(s.span,{className:"token operator",children:"-"}),"webpack",(0,a.jsx)(s.span,{className:"token operator",children:"-"}),"dev",(0,a.jsx)(s.span,{className:"token operator",children:"-"}),(0,a.jsx)(s.span,{className:"token keyword",children:"server"}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n  ",(0,a.jsx)(s.span,{className:"token punctuation",children:"}"}),"\n\n  ",(0,a.jsx)(s.span,{className:"token keyword",children:"location"})," @start",(0,a.jsx)(s.span,{className:"token operator",children:"-"}),"webpack",(0,a.jsx)(s.span,{className:"token operator",children:"-"}),"dev",(0,a.jsx)(s.span,{className:"token operator",children:"-"}),(0,a.jsx)(s.span,{className:"token keyword",children:"server"})," ",(0,a.jsx)(s.span,{className:"token punctuation",children:"{"}),"\n    ",(0,a.jsx)(s.span,{className:"token keyword",children:"default_type"})," text",(0,a.jsx)(s.span,{className:"token operator",children:"/"}),"plain",(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n    ",(0,a.jsx)(s.span,{className:"token keyword",children:"return"})," ",(0,a.jsx)(s.span,{className:"token number",children:"502"})," ",(0,a.jsx)(s.span,{className:"token string",children:'"Please start the webpack-dev-server first."'}),(0,a.jsx)(s.span,{className:"token punctuation",children:";"}),"\n  ",(0,a.jsx)(s.span,{className:"token punctuation",children:"}"}),"\n",(0,a.jsx)(s.span,{className:"token punctuation",children:"}"})]})}),"\n",(0,a.jsxs)(s.p,{children:["The ",(0,a.jsx)(s.code,{children:"proxy_set_header"})," lines are important, because they allow the WebSockets to work correctly."]}),"\n",(0,a.jsxs)(s.p,{children:["The command to start ",(0,a.jsx)(s.code,{children:"webpack-dev-server"})," can then be changed to this:"]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"hljs language-bash",children:"webpack serve --client-web-socket-url ws://10.10.10.61:8080/ws --watch-options-poll"})}),"\n",(0,a.jsxs)(s.p,{children:["This makes the server only accessible on ",(0,a.jsx)(s.code,{children:"127.0.0.1"}),", which is fine because nginx takes care of making it available on your host PC."]}),"\n",(0,a.jsxs)(s.h2,{children:[(0,a.jsx)(s.span,{id:"conclusion"}),"Conclusion",(0,a.jsx)(s.a,{href:"#conclusion","aria-hidden":"true",tabIndex:"-1",children:(0,a.jsx)(s.span,{className:"header-link"})})]}),"\n",(0,a.jsxs)(s.p,{children:["We made the Vagrant box accessible from a static IP, and then made ",(0,a.jsx)(s.code,{children:"webpack-dev-server"})," publicly accessible so it is reachable from a browser. We then tackled a common problem that VirtualBox doesn't send out filesystem events, causing the server to not reload on file changes."]})]})}function l(e={}){const{wrapper:s}={...(0,c.R)(),...e.components};return s?(0,a.jsx)(s,{...e,children:(0,a.jsx)(t,{...e})}):t(e)}}}]);