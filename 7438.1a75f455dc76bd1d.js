"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[7438],{7438:function(e,n,s){s.r(n),s.d(n,{default:function(){return l}});var a=s(2540),i=s(3317);function c(e){const n={a:"a",aside:"aside",code:"code",em:"em",h2:"h2",h6:"h6",li:"li",p:"p",pre:"pre",span:"span",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.p,{children:"In this guide, we'll dive into some of the best practices and utilities for building a production site or application."}),"\n",(0,a.jsxs)(n.aside,{className:"tip",children:[(0,a.jsx)(n.h6,{className:"tip__prefix",children:"tip"}),(0,a.jsxs)(n.p,{children:["This walkthrough stems from ",(0,a.jsx)(n.a,{href:"/guides/tree-shaking",children:"Tree Shaking"})," and ",(0,a.jsx)(n.a,{href:"/guides/development",children:"Development"}),". Please ensure you are familiar with the concepts/setup introduced in those guides before continuing on."]})]}),"\n",(0,a.jsxs)(n.h2,{children:[(0,a.jsx)(n.span,{id:"setup"}),"Setup",(0,a.jsx)(n.a,{href:"#setup","aria-hidden":"true",tabIndex:"-1",children:(0,a.jsx)(n.span,{className:"header-link"})})]}),"\n",(0,a.jsxs)(n.p,{children:["The goals of ",(0,a.jsx)(n.em,{children:"development"})," and ",(0,a.jsx)(n.em,{children:"production"})," builds differ greatly. In ",(0,a.jsx)(n.em,{children:"development"}),", we want strong source mapping and a localhost server with live reloading or hot module replacement. In ",(0,a.jsx)(n.em,{children:"production"}),", our goals shift to a focus on minified bundles, lighter weight source maps, and optimized assets to improve load time. With this logical separation at hand, we typically recommend writing ",(0,a.jsx)(n.strong,{children:"separate webpack configurations"})," for each environment."]}),"\n",(0,a.jsxs)(n.p,{children:["While we will separate the ",(0,a.jsx)(n.em,{children:"production"})," and ",(0,a.jsx)(n.em,{children:"development"})," specific bits out, note that we'll still maintain a \"common\" configuration to keep things DRY. In order to merge these configurations together, we'll use a utility called ",(0,a.jsx)(n.a,{href:"https://github.com/survivejs/webpack-merge",children:(0,a.jsx)(n.code,{children:"webpack-merge"})}),'. With the "common" configuration in place, we won\'t have to duplicate code within the environment-specific configurations.']}),"\n",(0,a.jsxs)(n.p,{children:["Let's start by installing ",(0,a.jsx)(n.code,{children:"webpack-merge"})," and splitting out the bits we've already worked on in previous guides:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsxs)(n.code,{className:"hljs language-bash",children:[(0,a.jsx)(n.span,{className:"token function",children:"npm"})," ",(0,a.jsx)(n.span,{className:"token function",children:"install"})," --save-dev webpack-merge"]})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"project"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsxs)(n.code,{className:"hljs language-diff",children:[(0,a.jsxs)(n.span,{className:"token unchanged",children:[(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:" webpack-demo\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:" |- package.json\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:" |- package-lock.json\n"})]}),(0,a.jsxs)(n.span,{className:"token deleted-sign deleted",children:[(0,a.jsx)(n.span,{className:"token prefix deleted",children:"-"}),(0,a.jsx)(n.span,{className:"token line",children:" |- webpack.config.js\n"})]}),(0,a.jsxs)(n.span,{className:"token inserted-sign inserted",children:[(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:" |- webpack.common.js\n"}),(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:" |- webpack.dev.js\n"}),(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:" |- webpack.prod.js\n"})]}),(0,a.jsxs)(n.span,{className:"token unchanged",children:[(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:" |- /dist\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:" |- /src\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"   |- index.js\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"   |- math.js\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:" |- /node_modules"})]})]})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"webpack.common.js"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"hljs language-diff",children:(0,a.jsxs)(n.span,{className:"token inserted-sign inserted",children:[(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:" const path = require('path');\n"}),(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:" const HtmlWebpackPlugin = require('html-webpack-plugin');\n"}),(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"\n"}),(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:" module.exports = {\n"}),(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"   entry: {\n"}),(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"     app: './src/index.js',\n"}),(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"   },\n"}),(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"   plugins: [\n"}),(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"     new HtmlWebpackPlugin({\n"}),(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"       title: 'Production',\n"}),(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"     }),\n"}),(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"   ],\n"}),(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"   output: {\n"}),(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"     filename: '[name].bundle.js',\n"}),(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"     path: path.resolve(__dirname, 'dist'),\n"}),(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"     clean: true,\n"}),(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"   },\n"}),(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:" };"})]})})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"webpack.dev.js"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"hljs language-diff",children:(0,a.jsxs)(n.span,{className:"token inserted-sign inserted",children:[(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:" const { merge } = require('webpack-merge');\n"}),(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:" const common = require('./webpack.common.js');\n"}),(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"\n"}),(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:" module.exports = merge(common, {\n"}),(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"   mode: 'development',\n"}),(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"   devtool: 'inline-source-map',\n"}),(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"   devServer: {\n"}),(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"     static: './dist',\n"}),(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"   },\n"}),(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:" });"})]})})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"webpack.prod.js"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"hljs language-diff",children:(0,a.jsxs)(n.span,{className:"token inserted-sign inserted",children:[(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:" const { merge } = require('webpack-merge');\n"}),(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:" const common = require('./webpack.common.js');\n"}),(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"\n"}),(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:" module.exports = merge(common, {\n"}),(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"   mode: 'production',\n"}),(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:" });"})]})})}),"\n",(0,a.jsxs)(n.p,{children:["In ",(0,a.jsx)(n.code,{children:"webpack.common.js"}),", we now have setup our ",(0,a.jsx)(n.code,{children:"entry"})," and ",(0,a.jsx)(n.code,{children:"output"})," configuration and we've included any plugins that are required for both environments. In ",(0,a.jsx)(n.code,{children:"webpack.dev.js"}),", we've set ",(0,a.jsx)(n.code,{children:"mode"})," to ",(0,a.jsx)(n.code,{children:"development"}),". Also, we've added the recommended ",(0,a.jsx)(n.code,{children:"devtool"})," for that environment (strong source mapping), as well as our ",(0,a.jsx)(n.code,{children:"devServer"})," configuration. Finally, in ",(0,a.jsx)(n.code,{children:"webpack.prod.js"}),",",(0,a.jsx)(n.code,{children:"mode"})," is set to ",(0,a.jsx)(n.code,{children:"production"})," which loads ",(0,a.jsx)(n.a,{href:"/plugins/terser-webpack-plugin/",children:(0,a.jsx)(n.code,{children:"TerserPlugin"})}),", which was first introduced by the ",(0,a.jsx)(n.a,{href:"/guides/tree-shaking/",children:"tree shaking"})," guide."]}),"\n",(0,a.jsxs)(n.p,{children:["Note the use of ",(0,a.jsx)(n.code,{children:"merge()"})," calls in the environment-specific configurations to include our common configuration in ",(0,a.jsx)(n.code,{children:"webpack.dev.js"})," and ",(0,a.jsx)(n.code,{children:"webpack.prod.js"}),". The ",(0,a.jsx)(n.code,{children:"webpack-merge"})," tool offers a variety of advanced features for merging but for our use case we won't need any of that."]}),"\n",(0,a.jsxs)(n.h2,{children:[(0,a.jsx)(n.span,{id:"npm-scripts"}),"NPM Scripts",(0,a.jsx)(n.a,{href:"#npm-scripts","aria-hidden":"true",tabIndex:"-1",children:(0,a.jsx)(n.span,{className:"header-link"})})]}),"\n",(0,a.jsxs)(n.p,{children:["Now, let's modify our npm scripts to use the new configuration files. For the ",(0,a.jsx)(n.code,{children:"start"})," script, which runs ",(0,a.jsx)(n.code,{children:"webpack-dev-server"}),", we will use ",(0,a.jsx)(n.code,{children:"webpack.dev.js"}),", and for the ",(0,a.jsx)(n.code,{children:"build"})," script, which runs ",(0,a.jsx)(n.code,{children:"webpack"})," to create a production build, we will use ",(0,a.jsx)(n.code,{children:"webpack.prod.js"}),":"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"package.json"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsxs)(n.code,{className:"hljs language-diff",children:[(0,a.jsxs)(n.span,{className:"token unchanged",children:[(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:" {\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:'   "name": "development",\n'}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:'   "version": "1.0.0",\n'}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:'   "description": "",\n'}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:'   "main": "src/index.js",\n'}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:'   "scripts": {\n'})]}),(0,a.jsxs)(n.span,{className:"token deleted-sign deleted",children:[(0,a.jsx)(n.span,{className:"token prefix deleted",children:"-"}),(0,a.jsx)(n.span,{className:"token line",children:'     "start": "webpack serve --open",\n'})]}),(0,a.jsxs)(n.span,{className:"token inserted-sign inserted",children:[(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:'     "start": "webpack serve --open --config webpack.dev.js",\n'})]}),(0,a.jsxs)(n.span,{className:"token deleted-sign deleted",children:[(0,a.jsx)(n.span,{className:"token prefix deleted",children:"-"}),(0,a.jsx)(n.span,{className:"token line",children:'     "build": "webpack"\n'})]}),(0,a.jsxs)(n.span,{className:"token inserted-sign inserted",children:[(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:'     "build": "webpack --config webpack.prod.js"\n'})]}),(0,a.jsxs)(n.span,{className:"token unchanged",children:[(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"   },\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:'   "keywords": [],\n'}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:'   "author": "",\n'}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:'   "license": "ISC",\n'}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:'   "devDependencies": {\n'}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:'     "css-loader": "^0.28.4",\n'}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:'     "csv-loader": "^2.1.1",\n'}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:'     "express": "^4.15.3",\n'}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:'     "file-loader": "^0.11.2",\n'}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:'     "html-webpack-plugin": "^2.29.0",\n'}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:'     "style-loader": "^0.18.2",\n'}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:'     "webpack": "^4.30.0",\n'}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:'     "webpack-dev-middleware": "^1.12.0",\n'}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:'     "webpack-dev-server": "^2.9.1",\n'}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:'     "webpack-merge": "^4.1.0",\n'}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:'     "xml-loader": "^1.2.1"\n'}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"   }\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:" }"})]})]})}),"\n",(0,a.jsxs)(n.p,{children:["Feel free to run those scripts and see how the output changes as we continue adding to our ",(0,a.jsx)(n.em,{children:"production"})," configuration."]}),"\n",(0,a.jsxs)(n.h2,{children:[(0,a.jsx)(n.span,{id:"specify-the-mode"}),"Specify the Mode",(0,a.jsx)(n.a,{href:"#specify-the-mode","aria-hidden":"true",tabIndex:"-1",children:(0,a.jsx)(n.span,{className:"header-link"})})]}),"\n",(0,a.jsxs)(n.p,{children:["Many libraries will key off the ",(0,a.jsx)(n.code,{children:"process.env.NODE_ENV"})," variable to determine what should be included in the library. For example, when ",(0,a.jsx)(n.code,{children:"process.env.NODE_ENV"})," is not set to ",(0,a.jsx)(n.code,{children:"'production'"})," some libraries may add additional logging and testing to make debugging easier. However, with ",(0,a.jsx)(n.code,{children:"process.env.NODE_ENV"})," set to ",(0,a.jsx)(n.code,{children:"'production'"})," they might drop or add significant portions of code to optimize how things run for your actual users. Since webpack v4, specifying ",(0,a.jsx)(n.a,{href:"/configuration/mode/",children:(0,a.jsx)(n.code,{children:"mode"})})," automatically configures ",(0,a.jsx)(n.code,{children:"process.env.NODE_ENV"})," for you through ",(0,a.jsx)(n.a,{href:"https://github.com/webpack/webpack/blob/fcccd192ce550210186f84a7ca59ee4cd47a8b2d/lib/WebpackOptionsApply.js#L565",children:(0,a.jsx)(n.code,{children:"DefinePlugin"})}),":"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"webpack.prod.js"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsxs)(n.code,{className:"hljs language-diff",children:[(0,a.jsxs)(n.span,{className:"token unchanged",children:[(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:" const { merge } = require('webpack-merge');\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:" const common = require('./webpack.common.js');\n"})]}),"\n",(0,a.jsxs)(n.span,{className:"token unchanged",children:[(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:" module.exports = merge(common, {\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"   mode: 'production',\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:" });"})]})]})}),"\n",(0,a.jsxs)(n.aside,{className:"tip",children:[(0,a.jsx)(n.h6,{className:"tip__prefix",children:"tip"}),(0,a.jsxs)(n.p,{children:["Technically, ",(0,a.jsx)(n.code,{children:"NODE_ENV"})," is a system environment variable that Node.js exposes into running scripts. It is used by convention to determine dev-vs-prod behavior by server tools, build scripts, and client-side libraries. Contrary to expectations, ",(0,a.jsx)(n.code,{children:"process.env.NODE_ENV"})," is not set ",(0,a.jsx)(n.strong,{children:"within"})," the build script ",(0,a.jsx)(n.code,{children:"webpack.config.js"})," automatically when running webpack. Thus, conditionals like ",(0,a.jsx)(n.code,{children:"process.env.NODE_ENV === 'production' ? '[name].[contenthash].bundle.js' : '[name].bundle.js'"})," won't work in webpack configurations unless you specify ",(0,a.jsx)(n.code,{children:"NODE_ENV"})," explicitly with ",(0,a.jsx)(n.code,{children:"NODE_ENV=production"})," through CLI."]})]}),"\n",(0,a.jsxs)(n.p,{children:["If you're using a library like ",(0,a.jsx)(n.a,{href:"https://reactjs.org/",children:(0,a.jsx)(n.code,{children:"react"})}),", you should actually see a significant drop in bundle size after adding ",(0,a.jsx)(n.code,{children:"DefinePlugin"}),". Also, note that any of our local ",(0,a.jsx)(n.code,{children:"/src"})," code can key off of this as well, so the following check would be valid:"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"src/index.js"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsxs)(n.code,{className:"hljs language-diff",children:[(0,a.jsxs)(n.span,{className:"token unchanged",children:[(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:" import { cube } from './math.js';\n"})]}),(0,a.jsxs)(n.span,{className:"token inserted-sign inserted",children:[(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"\n"}),(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:" if (process.env.NODE_ENV !== 'production') {\n"}),(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"   console.log('Looks like we are in development mode!');\n"}),(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:" }\n"})]}),"\n",(0,a.jsxs)(n.span,{className:"token unchanged",children:[(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:" function component() {\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"   const element = document.createElement('pre');\n"})]}),"\n",(0,a.jsxs)(n.span,{className:"token unchanged",children:[(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"   element.innerHTML = [\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"     'Hello webpack!',\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"     '5 cubed is equal to ' + cube(5)\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"   ].join('\\n\\n');\n"})]}),"\n",(0,a.jsxs)(n.span,{className:"token unchanged",children:[(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"   return element;\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:" }\n"})]}),"\n",(0,a.jsxs)(n.span,{className:"token unchanged",children:[(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:" document.body.appendChild(component());"})]})]})}),"\n",(0,a.jsxs)(n.h2,{children:[(0,a.jsx)(n.span,{id:"minification"}),"Minification",(0,a.jsx)(n.a,{href:"#minification","aria-hidden":"true",tabIndex:"-1",children:(0,a.jsx)(n.span,{className:"header-link"})})]}),"\n",(0,a.jsxs)(n.p,{children:["Webpack v4+ will minify your code by default in ",(0,a.jsx)(n.a,{href:"/configuration/mode/#mode-production",children:(0,a.jsx)(n.code,{children:"production mode"})}),"."]}),"\n",(0,a.jsxs)(n.p,{children:["Note that while the ",(0,a.jsx)(n.a,{href:"/plugins/terser-webpack-plugin/",children:(0,a.jsx)(n.code,{children:"TerserPlugin"})})," is a great place to start for minification and being used by default, there are other options out there:"]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"https://github.com/webpack-contrib/closure-webpack-plugin",children:(0,a.jsx)(n.code,{children:"ClosureWebpackPlugin"})})}),"\n"]}),"\n",(0,a.jsxs)(n.p,{children:["If you decide to try another minification plugin, make sure your new choice also drops dead code as described in the ",(0,a.jsx)(n.a,{href:"/guides/tree-shaking",children:"tree shaking"})," guide and provide it as the ",(0,a.jsx)(n.a,{href:"/configuration/optimization/#optimizationminimizer",children:(0,a.jsx)(n.code,{children:"optimization.minimizer"})}),"."]}),"\n",(0,a.jsxs)(n.h2,{children:[(0,a.jsx)(n.span,{id:"source-mapping"}),"Source Mapping",(0,a.jsx)(n.a,{href:"#source-mapping","aria-hidden":"true",tabIndex:"-1",children:(0,a.jsx)(n.span,{className:"header-link"})})]}),"\n",(0,a.jsxs)(n.p,{children:["We encourage you to have source maps enabled in production, as they are useful for debugging as well as running benchmark tests. That said, you should choose one with a fairly quick build speed that's recommended for production use (see ",(0,a.jsx)(n.a,{href:"/configuration/devtool",children:(0,a.jsx)(n.code,{children:"devtool"})}),"). For this guide, we'll use the ",(0,a.jsx)(n.code,{children:"source-map"})," option in the ",(0,a.jsx)(n.em,{children:"production"})," as opposed to the ",(0,a.jsx)(n.code,{children:"inline-source-map"})," we used in the ",(0,a.jsx)(n.em,{children:"development"}),":"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"webpack.prod.js"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsxs)(n.code,{className:"hljs language-diff",children:[(0,a.jsxs)(n.span,{className:"token unchanged",children:[(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:" const { merge } = require('webpack-merge');\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:" const common = require('./webpack.common.js');\n"})]}),"\n",(0,a.jsxs)(n.span,{className:"token unchanged",children:[(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:" module.exports = merge(common, {\n"}),(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:"   mode: 'production',\n"})]}),(0,a.jsxs)(n.span,{className:"token inserted-sign inserted",children:[(0,a.jsx)(n.span,{className:"token prefix inserted",children:"+"}),(0,a.jsx)(n.span,{className:"token line",children:"   devtool: 'source-map',\n"})]}),(0,a.jsxs)(n.span,{className:"token unchanged",children:[(0,a.jsx)(n.span,{className:"token prefix unchanged",children:" "}),(0,a.jsx)(n.span,{className:"token line",children:" });"})]})]})}),"\n",(0,a.jsxs)(n.aside,{className:"tip",children:[(0,a.jsx)(n.h6,{className:"tip__prefix",children:"tip"}),(0,a.jsxs)(n.p,{children:["Avoid ",(0,a.jsx)(n.code,{children:"inline-***"})," and ",(0,a.jsx)(n.code,{children:"eval-***"})," use in production as they can increase bundle size and reduce the overall performance."]})]}),"\n",(0,a.jsxs)(n.h2,{children:[(0,a.jsx)(n.span,{id:"minimize-css"}),"Minimize CSS",(0,a.jsx)(n.a,{href:"#minimize-css","aria-hidden":"true",tabIndex:"-1",children:(0,a.jsx)(n.span,{className:"header-link"})})]}),"\n",(0,a.jsxs)(n.p,{children:["It is crucial to minimize your CSS for production. Please see the ",(0,a.jsx)(n.a,{href:"/plugins/mini-css-extract-plugin/#minimizing-for-production",children:"Minimizing for Production"})," section."]}),"\n",(0,a.jsxs)(n.h2,{children:[(0,a.jsx)(n.span,{id:"cli-alternatives"}),"CLI Alternatives",(0,a.jsx)(n.a,{href:"#cli-alternatives","aria-hidden":"true",tabIndex:"-1",children:(0,a.jsx)(n.span,{className:"header-link"})})]}),"\n",(0,a.jsxs)(n.p,{children:["Many of the options described above can be set as command line arguments. For example, ",(0,a.jsx)(n.a,{href:"/configuration/optimization/#optimizationminimize",children:(0,a.jsx)(n.code,{children:"optimization.minimize"})})," can be set with ",(0,a.jsx)(n.code,{children:"--optimization-minimize"}),", and ",(0,a.jsx)(n.a,{href:"/configuration/mode/",children:(0,a.jsx)(n.code,{children:"mode"})})," can be set with ",(0,a.jsx)(n.code,{children:"--mode"}),". Run ",(0,a.jsx)(n.code,{children:"npx webpack --help=verbose"})," for a full list of CLI arguments."]}),"\n",(0,a.jsx)(n.p,{children:"While these shorthand methods are useful, we recommend setting these options in a webpack configuration file for more configurability."})]})}function l(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}}}]);